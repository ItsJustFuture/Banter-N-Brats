<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no, viewport-fit=cover" name="viewport"/>
<title>Banter &amp; Brats</title>
<script src="/theme-init.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=JetBrains+Mono:wght@400;600&amp;family=Nunito:wght@400;600;700&amp;family=Poppins:wght@400;500;600;700&amp;family=Rubik:wght@400;500;600;700&amp;family=Montserrat:wght@400;500;600;700&amp;family=Space+Grotesk:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="/styles.css" rel="stylesheet"/>
</head>
<body>
<div aria-live="polite" class="authLoading" id="authLoading">Checking your session...</div>
<!-- AUTH -->
<div id="loginView">
<div aria-hidden="true" class="loginBackdrop"></div>
<div class="loginShell">
<div class="loginBrand">
<div class="loginBadge">Welcome to</div>
<h1 class="loginLogo">Banter <span class="amp">&amp;</span> Brats</h1>
<p class="loginTag">18+ community chat built for rooms, DMs, and a little chaos.</p>
<ul class="loginFeatures">
<li>Pick rooms, hop into DMs, and keep tabs on reactions.</li>
<li>Track XP, gold, and shout-outs in leaderboards.</li>
<li>Keep it cozy with themes, vibes, and profile flair.</li>
</ul>
</div>
<div aria-label="Login or register" class="loginCard" role="dialog">
<div class="loginHeader">
<h2>Sign in</h2>
<p>Use your username and password to continue.</p>
</div>
<form class="loginForm" id="authForm">
<div class="field">
<label for="authUser">Username</label>
<input autocomplete="username" id="authUser" placeholder="your username" required=""/>
</div>
<div class="field">
<label for="authPass">Password</label>
<div class="passWrap">
<input autocomplete="current-password" id="authPass" placeholder="your password" required="" type="password"/>
<button aria-label="Show password" class="passToggle" id="togglePassBtn" title="Show password" type="button">ğŸ‘</button>
</div>
</div>
<div aria-live="polite" class="loginValidation" id="authValidation"></div>
<div class="field" hidden="" id="captchaWrap">
<div id="captchaWidget"></div>
<div class="small muted" id="captchaNote"></div>
</div>
<div class="row loginActions">
<button class="btn" id="loginBtn" type="submit">Join chat</button>
<button class="btn secondary" id="regBtn" type="button">Create account</button>
</div>
<div class="loginHint small muted">No email needed. Just claim a username.</div>
<div aria-live="polite" class="msgline" id="authMsg"></div>
</form>
<div class="loginFooter small muted">
          By continuing, you confirm you are 18+ and agree to follow the community rules.
</div>
</div>
</div>
</div>
<!-- PASSWORD UPGRADE -->
<div hidden="" id="passwordUpgradeView">
<div aria-hidden="true" class="upgradeBackdrop"></div>
<div class="upgradeShell">
<div class="upgradeCard loginCard" role="dialog" aria-label="Password upgrade required">
<div class="loginHeader">
<h2>Upgrade your password</h2>
<p>For security, passwords must be 12+ characters.</p>
</div>
<form class="loginForm" id="passwordUpgradeForm">
<div class="field">
<label for="upgradeCurrentPass">Current password</label>
<input autocomplete="current-password" id="upgradeCurrentPass" required="" type="password"/>
</div>
<div class="field">
<label for="upgradeNewPass">New password (12+)</label>
<input autocomplete="new-password" id="upgradeNewPass" required="" type="password"/>
</div>
<div class="field">
<label for="upgradeConfirmPass">Confirm new password</label>
<input autocomplete="new-password" id="upgradeConfirmPass" required="" type="password"/>
</div>
<div class="upgradeHints small muted">
<div class="upgradeHintsTitle">Quick tips</div>
<ul>
<li>Use 3+ words.</li>
<li>Add numbers or symbols.</li>
<li>Mix upper/lowercase.</li>
</ul>
</div>
<div aria-live="polite" class="loginValidation" id="passwordUpgradeMsg"></div>
<div class="row loginActions">
<button class="btn" id="passwordUpgradeSubmitBtn" type="submit">Update password</button>
<button class="btn secondary" id="passwordUpgradeLogoutBtn" type="button">Logout</button>
</div>
</form>
</div>
</div>
</div>
<!-- RESTRICTED (Kick/Ban) -->
<div hidden="" id="restrictedView">
<div class="restrictedShell">
<div class="restrictedCard">
<div aria-hidden="true" class="restrictedIcon">âš ï¸</div>
<h2 id="restrictedTitle">Restricted</h2>
<div class="restrictedSub" id="restrictedSub">You cannot access the chat right now.</div>
<div class="restrictedTimer" hidden="" id="restrictedTimerWrap">
<div class="restrictedTimerLabel">You can re-enter in</div>
<div class="restrictedTimerValue" id="restrictedTimer">00:00:00</div>
</div>
<div class="restrictedReason">
<div class="small muted">Reason</div>
<div class="restrictedReasonText" id="restrictedReasonText">â€”</div>
</div>
<div class="restrictedAppeal">
<div class="restrictedAppealHeader">
<div class="title">Appeal</div>
<div class="small muted" id="appealStatusText">One ticket per user.</div>
</div>
<div class="appealThread" id="appealThread"></div>
<div class="appealComposer">
<textarea id="appealInput" maxlength="2000" placeholder="Explain your appeal..." rows="3"></textarea>
<div class="row" style="gap:10px; flex-wrap:wrap;">
<button class="btn" id="appealSendBtn" type="button">Send appeal</button>
<button class="btn secondary" id="appealRefreshBtn" type="button">Refresh</button>
<div class="msgline" id="appealMsg"></div>
</div>
</div>
</div>
<div class="row" style="gap:10px; justify-content:center; margin-top:14px;">
<button class="btn secondary" id="restrictedRecheckBtn" type="button">Re-check access</button>
<button class="btn danger" id="restrictedLogoutBtn" type="button">Logout</button>
</div>
</div>
</div>
</div>
<!-- APP -->
<div hidden="" id="chatView">
<div id="app">
<div class="layout">
<aside class="channels" id="channelsPane">
<div class="brand">
<strong class="neonBrand">Banter <span class="amp">&amp;</span> Brats</strong>
<div class="small" id="nowRoom">main</div>
</div>
<div class="chanHeader">
<div class="small" id="chanHeaderTitle">Rooms</div>
<div class="row" style="gap:6px;">
<button class="iconBtn smallIcon" id="channelsCloseBtn" title="Close" type="button">âœ•</button>
<button class="iconBtn smallIcon" id="menuToggleBtn" title="Menu" type="button">â˜°</button>
<div class="roomActionsWrap">
<button class="iconBtn smallIcon" id="manageRoomsBtn" title="Manage rooms" type="button">â‹¯</button>
<div class="roomActionsMenu" id="roomActionsMenu" hidden="">
<button type="button" data-room-action="add-category">Add category</button>
<button type="button" data-room-action="add-room">Add room</button>
<button type="button" data-room-action="add-vip-room">Add VIP room</button>
<button type="button" data-room-action="manage-rooms">Manage rooms</button>
</div>
</div>
</div>
</div>
<div class="roomsPanel" id="roomsPanel">
<div class="latestUpdate" id="latestUpdate">
<div class="latestUpdateTop">
<div class="latestUpdateHeading">
<div class="small muted">Latest update</div>
<div class="latestUpdateTitle" id="latestUpdateTitle">â€”</div>
<div class="small" id="latestUpdateDate"></div>
<div class="changelogReactions latestUpdateReactions" id="latestUpdateReactions"></div>
</div>
<button class="btn secondary" id="latestUpdateViewBtn" type="button">View</button>
</div>
<div class="latestUpdateBody" id="latestUpdateBody"></div>
</div>
<div class="chanList" id="chanList">
<!-- will be rendered by app.js from /rooms -->
</div>
</div>
<div class="menuPanel" id="menuPanel">
<div class="menuNav" id="menuNav">
<button class="menuTab active" data-menu-tab="changelog" type="button">Changelog</button>
<button class="menuTab" data-menu-tab="rules" type="button">Rules</button>
<button class="menuTab" data-menu-tab="faq" type="button">FAQ</button>
<button class="menuTab" data-menu-tab="daily" type="button">Daily</button>
<button class="menuTab" data-menu-tab="leaderboards" type="button">Leaderboards</button>
</div>
<div class="menuContent">
<div class="menuSection" data-menu-section="changelog">
<div class="menuSectionHeader">
<div>
<div class="title">Changelog</div>
<div class="small muted">Newest updates appear first.</div>
</div>
<div class="menuActions" id="changelogActions">
<button class="btn" id="changelogNewBtn" type="button">New entry</button>
</div>
</div>
<div class="card" id="changelogEditor">
<div class="field">
<label for="changelogTitleInput">Title</label>
<input id="changelogTitleInput" maxlength="120" placeholder="What's new?"/>
</div>
<div class="field">
<label for="changelogBodyInput">Details</label>
<textarea id="changelogBodyInput" maxlength="8000" placeholder="Describe the change..." rows="4"></textarea>
</div>
<div class="row" style="align-items:center; gap:10px; flex-wrap:wrap;">
<button class="btn" id="changelogSaveBtn" type="button">Save</button>
<button class="btn secondary" id="changelogCancelBtn" type="button">Cancel</button>
<div class="msgline" id="changelogEditMsg"></div>
</div>
</div>
<div class="msgline" id="changelogMsg"></div>
<div class="changelogList" id="changelogList"></div>
</div>
<div class="menuSection" data-menu-section="rules">
<div class="menuSectionHeader">
<div class="title">Rules</div>
</div>
<div class="card muted">Coming soon.</div>
</div>
<div class="menuSection" data-menu-section="faq">
<div class="menuSectionHeader">
<div class="title">Questions</div>
<div class="menuActions">
<button class="btn" id="faqAskBtn" type="button">Ask a question</button>
</div>
</div>
<div class="faqForm" id="faqForm">
<div class="field">
<label for="faqTitleInput">Question</label>
<input id="faqTitleInput" maxlength="140" placeholder="What do you want to know?">
</input></div>
<div class="field">
<label for="faqDetailsInput">Details (optional)</label>
<textarea id="faqDetailsInput" maxlength="1000" placeholder="Add context or examples..." rows="3"></textarea>
</div>
<div class="row" style="align-items:center; gap:10px; flex-wrap:wrap;">
<button class="btn" id="faqSubmitBtn" type="button">Submit</button>
<button class="btn secondary" id="faqCancelBtn" type="button">Cancel</button>
<div class="msgline" id="faqEditMsg"></div>
</div>
</div>
<div class="msgline" id="faqMsg"></div>
<div class="faqList" id="faqList"></div>
</div>
<div class="menuSection" data-menu-section="leaderboards">
<div class="menuSectionHeader">
<div>
<div class="title">Leaderboards</div>
<div class="small muted">XP, Gold, Dice sixes, and profile likes.</div>
</div>
<div class="menuActions">
<button class="btn secondary" id="refreshLeaderboardsBtn" type="button">Refresh</button>
</div>
</div>
<div class="msgline" id="leaderboardsMsg"></div>
<div class="small muted" id="leaderboardsUpdatedAt"></div>
<div class="leaderboardGrid">
<div class="card leaderboardCard">
<div class="sectionTitle">XP leaderboard</div>
<div class="leaderboardList" id="leaderboardXp"></div>
</div>
<div class="card leaderboardCard">
<div class="sectionTitle">Gold leaderboard</div>
<div class="leaderboardList" id="leaderboardGold"></div>
</div>
<div class="card leaderboardCard">
<div class="sectionTitle">Dice leaderboard</div>
<div class="leaderboardList" id="leaderboardDice"></div>
</div>
<div class="card leaderboardCard">
<div class="sectionTitle">Profile likes</div>
<div class="leaderboardList" id="leaderboardLikes"></div>
</div>
<div class="card leaderboardCard">
<div class="sectionTitle">Chess leaderboard</div>
<div class="leaderboardList" id="leaderboardChess"></div>
</div>
</div>
</div>
</div>
</div>
<div aria-live="polite" class="commandPopup" id="commandPopup">
<div class="commandPopupHeader">
<div class="commandPopupTitle" id="commandPopupTitle">Command</div>
<button class="iconBtn" id="commandPopupClose" title="Dismiss" type="button">âœ•</button>
</div>
<div class="commandPopupBody" id="commandPopupBody"></div>
</div>
<div class="bottomBar">
<div class="meRow">
<div class="meLeft">
<div class="meAvatar" id="meAvatar"></div>
<div class="meMeta">
<div class="meName" id="meName">...</div>
<div class="meRole" id="meRole">...</div>
</div>
</div>
<div class="row" style="gap:8px; align-items:center;">
<div class="meStatusText" id="meStatusText">Online</div>
<button class="iconBtn" id="profileBtn" title="Profile" type="button">ğŸ‘¤</button>
<button class="iconBtn" id="couplesBtn" title="Couples" type="button">ğŸ’œ</button>
</div>
</div>
<select id="statusSelect">
<option>Online</option>
<option>Away</option>
<option>Busy</option>
<option>DnD</option>
<option>Idle</option>
<option>Gaming</option>
<option>Music</option>
<option>Working</option>
<option>Chatting</option>
<option>Lurking</option>
</select>
</div>
</aside>
<main class="chat chat-main">
<div class="topbar">
<div class="roomEventBanner" hidden="" id="roomEventBanner"></div>
<div class="row topLeft" style="align-items:center; gap:10px;">
<button class="iconBtn mobOnly" id="openChannelsBtn" title="Channels" type="button">â˜°</button>
<div class="roomTitle"><span class="srOnly" id="roomTitle">main</span><button aria-label="Logout" class="iconBtn logoutTop" id="logoutTopBtn" title="Logout" type="button">â‹</button></div>
</div>
<div class="row topActions" style="align-items:center; gap:10px;">
<div class="searchWrap">
<input id="searchInput" placeholder="Search messages..."/>
</div>
<div aria-live="polite" class="levelToastInline" id="levelToast">ğŸ‰ <span id="levelToastText">Level up!</span></div>
<button class="iconBtn withBadge" id="dmToggleBtn" title="Direct messages" type="button">ğŸ’¬<span class="notifDot" id="dmBadgeDot" title="New DMs"></span></button>
<button class="iconBtn withBadge" id="groupDmToggleBtn" title="Group DMs" type="button">ğŸ‘¥<span class="notifDot" id="groupDmBadgeDot" title="New group DMs"></span></button>
<button aria-label="Notifications" class="iconBtn withBadge" id="notificationsBtn" title="Notifications" type="button">ğŸ””<span class="notifDot" id="notificationsDot" title="New notifications"></span></button>
<button class="iconBtn" id="roomChessBtn" title="Chess Table" type="button">â™Ÿ</button>
<button aria-label="Open Simulator" class="btn secondary small survivalOpenBtn" hidden id="survivalOpenBtn" title="Open Simulator" type="button">ğŸ§­</button>
<button class="iconBtn mobOnly" id="openMembersBtn" title="Members" type="button">ğŸ‘¥</button>
</div>
</div>
<!-- Quick avatar strips (shown before opening the DM panel) -->
<div class="dmQuickBar" hidden="" id="dmQuickBar">
<div aria-label="Your direct message threads" class="dmQuickStrip" id="dmQuickStrip"></div>
<div class="dmQuickEmpty" hidden="" id="dmQuickEmpty">No active DMs</div>
</div>
<div class="dmQuickBar" hidden="" id="groupQuickBar">
<div aria-label="Your group message threads" class="dmQuickStrip" id="groupQuickStrip"></div>
<div class="dmQuickEmpty" hidden="" id="groupQuickEmpty">
<div class="dmQuickEmptyText">No active Group DMs</div>
<button class="btn dmQuickEmptyBtn" id="groupQuickStartBtn" type="button">Start a new Group DM</button>
</div>
</div>
<div aria-live="polite" class="ytSticky is-hidden" id="ytSticky">
<div class="ytStickyInner">
<div class="ytStickyHeader">
<div class="ytStickyInfo">
<div aria-hidden="true" class="ytStickyThumb" id="ytStickyThumb"></div>
<div class="ytStickyText">
<div class="ytStickyTitle" id="ytStickyTitle">YouTube player</div>
<div class="ytStickyChannel" id="ytStickyChannel"></div>
</div>
</div>
<div class="ytStickyHeaderActions">
<button aria-label="Play" class="iconBtn" id="ytPlayPause" type="button">â–¶</button>
<button aria-label="Minimize player" class="iconBtn" id="ytMinimize" type="button">â€”</button>
<button aria-label="Close player" class="iconBtn" id="ytClose" type="button">âœ•</button>
</div>
</div>
<div class="ytStickyBody" id="ytBody">
<div class="ytStickyControls">
<div class="ytSeekRow">
<span class="ytTime" id="ytCurrentTime">0:00</span>
<input aria-label="Seek" id="ytSeek" min="0" step="1" type="range" value="0"/>
<span class="ytTime" id="ytDuration">--:--</span>
</div>
<div class="ytControlRow">
<div class="ytVolumeControls">
<button aria-label="Mute" class="iconBtn" id="ytMute" type="button">ğŸ”Š</button>
<input aria-label="Volume" id="ytVolume" max="100" min="0" step="1" type="range" value="60"/>
</div>
<label class="ytSelectLabel">Quality
                    <select aria-label="Quality" id="ytQuality"></select>
</label>
</div>
</div>
<div class="ytPlayerHolder">
<div id="ytStickyFrame"></div>
</div>
</div>
</div>
</div>
<div class="notificationsModal" hidden="" id="notificationsModal">
<div class="modalCard notificationsCard">
<div class="modalTop">
<strong>Notifications</strong>
<button aria-label="Close" class="iconBtn" id="notificationsCloseBtn" type="button">âœ•</button>
</div>
<div class="modalBody">
<div class="notificationsActions">
<button class="btn secondary small" id="notificationsClearBtn" type="button">Clear all</button>
</div>
<div class="notificationsList" id="notificationsList"></div>
<div class="small muted" id="notificationsEmpty">No notifications yet. Mentions are coming soon.</div>
</div>
</div>
</div>
<div class="modal" hidden="" id="survivalModal">
<div class="modalCard survivalModal survivalModalShell">
<div class="modalTop survivalModalTop">
<div class="survivalModalHeading">
<strong>Survival Simulator</strong>
<div class="survivalModalMeta">
<span class="survivalModalSeason" id="survivalSeasonTitle">No season</span>
<span class="survivalModalStatus" id="survivalStatus">No season</span>
<span class="survivalModalPhase" id="survivalDayPhase">Day 1 â€” Day</span>
<span class="survivalModalAlive" id="survivalAliveCount">Alive: 0</span>
</div>
</div>
<button aria-label="Close" class="iconBtn" id="survivalModalClose" type="button">âœ•</button>
</div>
<div class="survivalModalTabs">
<button class="pillBtn active" id="survivalLogBtn" type="button">Log</button>
<button class="pillBtn" id="survivalArenaBtn" type="button">Map</button>
<button class="pillBtn" id="survivalControlsBtn" type="button">Controls</button>
</div>
<div class="modalBody survivalModalBody">
<section class="survivalModalSection" data-survival-view="log">
<div class="survivalLogHeaderRow">
<button class="btn secondary small" id="survivalLogLoadBtn" type="button">Load older</button>
<label class="survivalHistoryLabel">History
<select id="survivalHistorySelect"></select>
</label>
</div>
<div class="survivalLogList" id="survivalLogModalList"></div>
</section>
<section class="survivalModalSection" data-survival-view="map" hidden>
<div class="survivalArena" id="survivalArena">
<div class="survivalArenaHeader">
<span class="survivalArenaTitle">Arena Map</span>
<span class="small muted" id="survivalLobbyCount"></span>
</div>
<div class="survivalArenaGrid" id="survivalArenaGrid"></div>
</div>
</section>
<section class="survivalModalSection" data-survival-view="controls" hidden>
<div class="survivalPanelControls">
<div class="survivalPanelGroup">
<button class="btn secondary small" id="survivalNewSeasonBtn" type="button">New Season</button>
<button class="btn secondary small" id="survivalAdvanceBtn" type="button">Advance</button>
<button class="btn secondary small" id="survivalAutoRunBtn" type="button">Auto-Run</button>
<button class="btn secondary small" id="survivalEndBtn" type="button">Reset/End</button>
</div>
<div class="survivalPanelGroup">
<button class="btn secondary small" id="survivalLobbyBtn" type="button">Opt-in</button>
</div>
</div>
<div class="survivalNewSeasonPanel" hidden id="survivalNewSeasonPanel">
<div class="survivalPanelHeader">
<div class="survivalPanelTitle">
<span class="survivalPanelName">New Survival Season</span>
<span class="small muted">Set up a fresh run.</span>
</div>
<div class="survivalPanelMeta">
<button aria-label="Close" class="iconBtn" id="survivalNewSeasonClose" type="button">âœ•</button>
</div>
</div>
<label class="fieldLabel">Title
  <input id="survivalSeasonTitleInput" maxlength="120" placeholder="Season â€” ..." type="text"/>
</label>
<div class="survivalPicker">
<div class="survivalPickerModes">
<label><input checked="" name="survivalPickMode" type="radio" value="online"/> Everyone online</label>
<label><input name="survivalPickMode" type="radio" value="select"/> Select users</label>
</div>
<div class="survivalParticipantList" id="survivalParticipantList"></div>
</div>
<div class="survivalOptions">
<label><input id="survivalCouplesToggle" type="checkbox"/> Include Couples synergy</label>
<label><input id="survivalChaosToggle" type="checkbox"/> Chaotic mode</label>
<label><input id="survivalLobbyToggle" type="checkbox"/> Include lobby signups</label>
<div class="survivalNpcFields">
<label class="small muted">Custom names (one per line... and set fill slots to auto-top-up)</label>
<textarea id="survivalNpcNames" placeholder="e.g.\nKat\nPeeta\nRue" rows="4"></textarea>
<div class="survivalNpcRow">
<label class="small muted">Fill slots (0 = no auto fill)</label>
<input id="survivalFillSlots" type="number" min="0" max="48" value="0"/>
</div>
</div>
</div>
<div class="modalActions">
<button class="btn" id="survivalSeasonStartBtn" type="button">Start</button>
</div>
<div class="small muted" id="survivalSeasonMsg"></div>
</div>
<div class="survivalRosterList" id="survivalRosterList"></div>
</section>
</div>
</div>
</div>
<div class="luckMeter" id="luckMeter">
  <div class="luckMeterHeader">
    <span class="luckMeterTitle">ğŸ€ Luck</span>
    <span class="luckMeterValue" id="luckMeterValue">0.00</span>
    <span class="luckMeterStreak" id="luckMeterStreak">Streak 0</span>
  </div>
  <div aria-label="Luck meter" class="luckMeterBar" id="luckMeterBar" role="meter" aria-valuemin="-2.0" aria-valuemax="0.30" aria-valuenow="0">
    <span class="luckMeterBarText" id="luckMeterBarText">|------------^------------|</span>
  </div>
</div>
<div class="msgs" id="msgs"></div>
<div class="typing" id="typing"></div>
<div class="uploadPreview" id="uploadPreview">
<div class="uploadLeft">
<div class="previewThumb" id="previewThumb"></div>
<div class="uploadMeta">
<div class="uploadName" id="uploadName"></div>
<div class="uploadInfo" id="uploadInfo"></div>
</div>
</div>
<div class="uploadRight">
<div class="progressWrap">
<div class="progressBar" id="uploadProgress"></div>
</div>
<button class="btn secondary" id="cancelUploadBtn" type="button">Cancel</button>
</div>
</div>
<div class="replyPreview" id="replyPreview">
<div class="replyText" id="replyPreviewText"></div>
<button aria-label="Cancel reply" class="iconBtn smallIcon" id="replyPreviewClose" type="button">âœ•</button>
</div>
<div class="inputBar">
  <input id="msgInput" maxlength="800" placeholder="Message main" type="text"/>

  <!-- hidden native inputs -->
  <input accept="image/*,video/mp4,video/quicktime" id="fileInput" type="file"/>
  <input accept="audio/mpeg,audio/mp4,.mp3,.m4a" id="audioFileInput" type="file"/>

  <!-- unified media button + pop-up menu -->
  <button class="iconBtn" id="mediaBtn" title="Media" type="button">ï¼‹</button>
  <div class="diceVariantWrap" id="diceVariantWrap">
    <button aria-expanded="false" aria-haspopup="menu" class="iconBtn diceVariantToggle" id="diceVariantToggle" title="Dice variants" type="button">
      <span class="diceVariantLabel" id="diceVariantLabel">d6</span>
      <span aria-hidden="true" class="diceVariantChevron">â–¾</span>
    </button>
    <button aria-label="Dice payouts" class="iconBtn diceInfoBtn" id="diceInfoBtn" title="Payouts" type="button">â“˜</button>
    <div class="diceVariantMenu" hidden="" id="diceVariantMenu" role="menu">
      <button aria-checked="true" class="diceVariantOption active" data-variant="d6" role="menuitemradio" type="button">d6</button>
      <button aria-checked="false" class="diceVariantOption" data-variant="d20" role="menuitemradio" type="button">d20</button>
      <button aria-checked="false" class="diceVariantOption" data-variant="2d6" role="menuitemradio" type="button">2d6</button>
      <button aria-checked="false" class="diceVariantOption" data-variant="d100" role="menuitemradio" type="button">1â€“100</button>
    </div>
    <div class="dicePayoutPopover" hidden="" id="dicePayoutPopover" role="dialog" aria-label="Dice payouts"></div>
  </div>
  <div class="mediaMenu" hidden="" id="mediaMenu">
    <button class="mediaMenuItem" id="mediaMenuImage" type="button" title="Upload image">
      <span class="mediaIcon">ğŸ–¼ï¸</span><span class="mediaLabel">Image</span>
    </button>
    <button class="mediaMenuItem" id="mediaMenuAudioUpload" type="button" title="Upload audio">
      <span class="mediaIcon">ğŸµ</span><span class="mediaLabel">Audio</span>
    </button>
    <button class="mediaMenuItem" id="mediaMenuVoice" type="button" title="Record voice">
      <span class="mediaIcon">ğŸ™ï¸</span><span class="mediaLabel" id="mediaVoiceLabel">Voice</span>
    </button>
  </div>

<div aria-label="Tone indicator" class="tonePicker" id="tonePicker"></div>
<button class="btn" id="sendBtn" type="button">Send</button>
<div class="mentionDropdown" id="mentionDropdown"></div>
</div>
</main>
<aside class="members drawer" id="membersPane">
<div class="drawerHeader">
<h3>Members</h3>
<button class="btn secondary small" hidden="" id="membersAdminMenuBtn" type="button" aria-haspopup="menu" aria-expanded="false">Admin</button>
<div class="adminDropdown" hidden="" id="membersAdminMenu" role="menu" aria-label="Admin tools">
  <div class="adminDropdownHeader">Admin Tools</div>
  <button class="adminDropdownItem" id="adminMenuAppealsBtn" type="button" role="menuitem">Appeals</button>
  <button class="adminDropdownItem" id="adminMenuReferralsBtn" type="button" role="menuitem">Referrals</button>
  <button class="adminDropdownItem" id="adminMenuCasesBtn" type="button" role="menuitem">Cases</button>
  <button class="adminDropdownItem" id="adminMenuRoleDebugBtn" type="button" role="menuitem">Role debug</button>
  <button class="adminDropdownItem" id="adminMenuFeatureFlagsBtn" type="button" role="menuitem">Flags</button>
  <button class="adminDropdownItem" id="adminMenuSessionsBtn" type="button" role="menuitem">Sessions</button>
</div>
<button class="iconBtn smallIcon" id="membersCloseBtn" title="Close" type="button">âœ•</button>
</div>
<div aria-live="polite" class="memberGold" id="memberGold"></div>
<div class="memberPills" id="memberPills">
<button class="pill active" id="memberPillRoom" type="button">Room</button>
<button class="pill" id="memberPillFriends" type="button">Friends</button>
</div>
<div id="memberList"></div>

<!-- Donation button temporarily disabled -->
<!--
<form action="https://www.paypal.com/ncp/payment/44EJ6AKA6YW42"
      method="post"
      target="_blank"
      class="paypalDonateMembersFooter"
      title="Support Banter & Brats">
  <button type="submit" aria-label="Donate">ğŸ’› donate ğŸ’›</button>
</form>
-->

<div class="memberMenu" id="memberMenu">
<div class="memberMenuHeader">
<div class="memberMenuName" id="memberMenuName"></div>
<div class="small" id="memberMenuHint">Quick actions</div>
</div>
<div class="memberMenuActions">
<button class="btn secondary" id="memberViewProfileBtn" type="button">View profile</button>
<button class="btn" id="memberDmBtn" type="button">DM</button>
<button class="btn secondary" id="memberReferBtn" style="display:none;" type="button">Refer ban</button>
<div class="memberMenuSection" id="memberModSection" style="display:none;">
<div class="memberMenuSectionTitle">Moderation</div>
<div class="memberMenuSectionActions">
<button class="btn secondary" id="memberKickBtn" type="button">Kick</button>
<button class="btn secondary" id="memberMuteBtn" type="button">Mute</button>
<button class="btn danger" id="memberBanBtn" type="button">Ban</button>
<button class="btn secondary" id="memberLogsBtn" type="button">View logs</button>
</div>
</div>

<div class="menuSection" data-menu-section="daily">
  <div class="menuSectionHeader">
    <div>
      <div class="title">Daily</div>
      <div class="small muted">Quick challenges for XP + gold.</div>
    </div>
    <div class="menuActions">
      <button class="btn secondary" id="dailyReloadBtn" type="button">Reload</button>
    </div>
  </div>
  <div class="msgline" id="dailyMsg"></div>
  <div class="dailyList" id="dailyList"></div>
</div>
</div>
</div>
</aside>
</div>
<!-- Mobile overlay (MUST live inside #app because #app is transformed, which creates a stacking context).
         If this sits outside #app it can render above the drawers and steal taps on iOS. -->
<div class="overlay" id="drawerOverlay"></div>
</div>
<!-- DM PANEL -->
<div class="dmPanel chat-dm" id="dmPanel">
<div class="dmHeader">
<div class="dmHeaderMain">
<button class="iconBtn secondary dmBackBtn" id="dmBackBtn" title="Back to inbox" type="button">â†</button>
<div class="title" id="dmHeaderTitle">Inbox</div>
</div>
<button class="iconBtn" id="dmCloseBtn" title="Close" type="button">âœ•</button>
</div>
<div class="dmContent">
<div class="dmThreads">
<div class="dmThreadsHeader">
<div>
<div class="title">Inbox</div>
<div class="small">Direct and group chats</div>
</div>
</div>
<div class="dmThreadList" id="dmThreadList"></div>
</div>
<div class="dmConversation">
<div class="dmMeta">
<div class="dmMetaText">
<div class="dmMetaTop">
<div class="dmMetaAvatar" id="dmMetaAvatar"></div>
<div class="title" id="dmMetaTitle">Pick a thread</div>
</div>
<div class="small" id="dmMetaPeople"></div>
	<!-- typing indicator is positioned near the composer so it never pushes the message list -->
</div>
<div class="dmMetaActions">
<button class="iconBtn secondary" id="dmChessBtn" title="Play Chess" type="button">â™Ÿ</button>
<button class="iconBtn secondary" id="dmCreateGroupBtn" title="Create group" type="button">â•</button>
<button class="iconBtn secondary" id="dmInfoBtn" title="Group info" type="button">â„¹ï¸</button>
<button class="iconBtn secondary" id="dmSettingsBtn" title="DM settings" type="button">âš™ï¸</button>
<div class="dmSettingsMenu" id="dmSettingsMenu">
<div class="dmSettingsRow">
  <label class="checkRow">
    <input id="dmTranslucentToggle" type="checkbox"/>
    <span>Translucent DM panel</span>
  </label>
  <div class="small">Makes the DM panel slightly see-through so you can still notice the room behind it.</div>
</div>
<div class="dmSettingsRow">
<button class="btn danger" id="dmDeleteHistoryBtn" type="button">Delete history</button>
<div class="small">Remove every message in this DM for all participants.</div>
</div>
<div class="dmSettingsRow">
<button class="btn secondary" id="dmReportBtn" type="button">Report DM (coming soon)</button>
</div>
</div>
</div>
</div>
<div class="dmChessChallenge" id="dmChessChallenge" hidden=""></div>
<div class="dmMessages" id="dmMessages"></div>
<div class="replyPreview" id="dmReplyPreview">
<div class="replyText" id="dmReplyPreviewText"></div>
<button aria-label="Cancel reply" class="iconBtn smallIcon" id="dmReplyClose" type="button">âœ•</button>
</div>
	<div class="dmInput">
	<div class="small dmTyping" id="dmTypingIndicator" aria-live="polite"></div>
<input id="dmText" maxlength="800" placeholder="Message"/>
<input accept="image/*" id="dmFileInput" style="display:none" type="file"/>
<button class="iconBtn" id="dmPickFileBtn" title="Upload image" type="button">ğŸ“·</button>
<div aria-label="Tone indicator" class="tonePicker" id="dmTonePicker"></div>
<button class="btn" id="dmSendBtn" type="button">Send</button>
<div class="mentionDropdown" id="dmMentionDropdown"></div>
</div>
</div>
</div>
</div>
<div class="dmModal" id="dmPickerModal">
<div class="dmModalCard">
<div class="dmModalHeader">
<div>
<div class="title" id="dmModalTitle">Create group</div>
<div class="small" id="dmModalSubtitle">Pick at least two people</div>
</div>
<button aria-label="Close" class="iconBtn" id="dmModalCloseBtn" type="button">âœ•</button>
</div>
<div class="field">
<label for="dmModalSearch">Search</label>
<input id="dmModalSearch" placeholder="Search by username" type="search"/>
</div>
<div class="dmPickerList" id="dmPickerList"></div>
<div class="dmModalActions">
<button class="btn secondary" id="dmModalCancelBtn" type="button">Cancel</button>
<button class="btn" disabled="" id="dmModalPrimaryBtn" type="button">Create</button>
</div>
</div>
</div>
<div class="dmModal" id="dmInfoModal">
<div class="dmModalCard">
<div class="dmModalHeader">
<div>
<div class="title" id="dmInfoTitle">Group info</div>
<div class="small" id="dmInfoSubtitle"></div>
</div>
<button aria-label="Close" class="iconBtn" id="dmInfoCloseBtn" type="button">âœ•</button>
</div>
<div class="dmInfoSection">
<div class="small">Members</div>
<div class="dmInfoMembers" id="dmInfoMembers"></div>
</div>
<div class="dmModalActions stacked">
<button class="btn secondary" id="dmInfoAddBtn" type="button">Add members</button>
<button class="btn danger" id="dmLeaveBtn" type="button">Leave group</button>
</div>
</div>
</div>
<!-- PROFILE / MODAL -->
<div id="modal">
<div class="modalCard profileModalCard">
<div class="modalTop profileModalTop">
<!-- Profile sheet header (compact layout) -->
<div class="profileSheetHero compact" id="profileSheetHero">
<div class="profileSheetBg" id="profileSheetBg"></div>
<div aria-hidden="true" class="profileSheetOverlay" id="profileSheetOverlay"></div>
<div class="profileSheetContent compact">
<div class="profileAvatarWrap">
<div class="profileSheetAvatarCard">
<div class="profileSheetAvatar" id="profileSheetAvatar"></div>
<div class="profileSheetAvatarActions" id="profileSheetAvatarActions" style="display:none;">
<button aria-label="Remove avatar" class="iconPill" id="profileAvatarRemoveBtn" type="button">
<span aria-hidden="true" class="ico">
<svg fill="none" viewbox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-linecap="round" stroke-width="2"></path></svg>
</span>
<span class="iconLabel">Remove</span>
</button>
<button aria-label="Change avatar" class="iconPill" id="profileAvatarChangeBtn" type="button">
<span aria-hidden="true" class="ico">
<svg fill="none" viewbox="0 0 24 24"><path d="M4 7h4l2-2h4l2 2h4v14H4V7z" stroke="currentColor" stroke-linejoin="round" stroke-width="2"></path><path d="M12 17a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" stroke="currentColor" stroke-width="2"></path></svg>
</span>
<span class="iconLabel">Change</span>
</button>
</div>
</div>
</div>
<span aria-hidden="true" class="profilePresenceDot" id="profilePresenceDot"></span>
<div class="profileSheetMeta">
<span class="srOnly" id="modalTitle">Profile</span>
<div class="profileSheetNameRow">
<span class="profileSheetName" id="profileSheetName">â€”</span>
<span class="profileRoleChip" id="profileSheetRoleChip">Role</span>
</div><div class="profileSheetMood"><span id="profileMood"></span></div>
<div class="profileSheetStats" id="profileSheetStats" style="display:none;">
<span class="statPill" id="profileSheetStars">â­ 0</span>
<span class="statPill" id="profileSheetLikes">â™¡ 0</span>
</div>
</div>
<div class="profileHeaderActions">
<button aria-label="Edit profile" class="iconBtn smallIcon" data-profile-action="profile:edit" id="profileEditBtn" style="display:none;" title="Edit profile" type="button">âœï¸</button>
<button aria-label="Moderation actions" class="iconBtn smallIcon" data-profile-action="profile:moderation-overlay" id="actionsBtn" style="display:none;" title="Moderation actions" type="button">ğŸ›¡ï¸</button>
<button aria-label="Close profile" class="iconBtn smallIcon" data-profile-action="profile:close" id="closeModalBtn" type="button">âœ•</button>
</div>
</div>
</div>
</div>
<div class="modalBody">
<div class="small" id="modalMeta" style="display:none;"></div>
<div class="profileSticky">
<div class="profileActions">
<div class="tabs profileActionTabs profileCompactTabs" id="profileTabs">
<button class="tab active" data-tab="profile" id="tabProfile" type="button">Profile</button>
<button class="tab" data-tab="timeline" id="tabTimeline" type="button">Timeline</button>
<button class="tab" data-tab="customize" id="tabCustomize" type="button">Customize</button>
<button class="tab" data-tab="actions" id="tabActions" style="display:none;" type="button">Actions</button>
</div>
<div class="msgline" id="profileActionMsg"></div>
<div class="msgline" id="profileLikeMsg"></div>
<div class="msgline" id="mediaMsg"></div>
</div>
</div>
<div class="modalContent" id="modalContent">
<div id="viewProfile">
<div class="profileSections" id="profileSections">
<details class="profileSection" data-section="actions" open="">
<summary>Actions</summary>
<div class="profileSectionBody">
<div class="profileQuickActions" id="profileQuickActions">
<div class="quickActionGroup">
<button class="btn btnSecondary" data-profile-action="profile:message" id="dmUserBtn" type="button">Message</button>
<button class="btn btnSecondary" data-profile-action="profile:chess" id="dmChessQuickBtn" type="button">Play Chess</button>
<button class="btn btnSecondary" data-profile-action="profile:friend" id="addFriendBtn" style="display:none;" type="button">ğŸ¤ Add Friend</button>
<button class="btn btnSecondary" data-profile-action="profile:friend-decline" id="declineFriendBtn" style="display:none;" type="button">âœ– Decline</button>
<button class="btn btnSecondary" data-profile-action="profile:like" id="likeProfileBtn" type="button">â¤ï¸ Like</button>
<button class="btn btnSecondary" data-profile-action="profile:toggle-edit" id="profileEditToggleBtn" style="display:none;" type="button">Edit profile</button>
</div>
</div>
</div>
</details>
<details class="profileSection" data-section="stats">
<summary>Stats</summary>
<div class="profileSectionBody">
<div class="profileInfoGrid">
<div class="profileInfoCard">
<div class="infoLabel">Age</div>
<div class="infoValue" id="infoAge">â€”</div>
</div>
<div class="profileInfoCard">
<div class="infoLabel">Gender</div>
<div class="infoValue" id="infoGender">â€”</div>
</div>
<div class="profileInfoCard">
<div class="infoLabel">Current room</div>
<div class="infoValue" id="infoRoom">â€”</div>
</div>
<div class="profileInfoCard">
<div class="infoLabel">Created</div>
<div class="infoValue" id="infoCreated">â€”</div>
</div>
<div class="profileInfoCard">
<div class="infoLabel">Last seen</div>
<div class="infoValue" id="infoLastSeen">â€”</div>
</div>
<div class="profileInfoCard">
<div class="infoLabel">Status</div>
<div class="infoValue" id="profileStatus">â€”</div>
</div>
<div class="profileInfoCard profileInfoWide">
<div class="infoLabel">Vibes</div>
<div class="vibeRow" id="profileSheetVibes"></div>
</div>
<div class="profileInfoCard profileInfoWide" id="profileCoupleCard" style="display:none;">
<div class="infoLabel">Couple</div>
<div class="coupleCardBody" id="profileCoupleBody" style="display:none;">
<div class="coupleCardHeader">
<div class="coupleCardAvatars" id="profileCoupleAvatars"></div>
<div class="coupleCardMeta">
<div class="coupleCardTitleRow">
<div class="coupleCardTitle" id="profileCoupleName"></div>
<span class="coupleBadge small" id="profileCoupleBadge" style="display:none;"></span>
</div>
<div class="coupleCardSub" id="profileCoupleMeta"></div>
</div>
</div>
<div class="coupleCardBio" id="profileCoupleBio"></div>
</div>
<span class="coupleChip" id="profileCoupleChip" style="display:none;"></span>
</div>
</div>
</div>
</details>
<details class="profileSection" data-section="about">
<summary>About</summary>
<div class="profileSectionBody">
<div class="profileBioCard" id="viewAbout">
<div class="sectionTitle">Bio</div>
<div class="bioRender" id="bioRender">(no bio)</div>
</div>
</div>
</details>
<details class="profileSection" data-section="customize">
<summary>Customization</summary>
<div class="profileSectionBody">
<div class="panelBox">
<div class="small">Jump into the full customization panel or apply a theme.</div>
<div class="row" style="margin-top:10px; gap:8px; flex-wrap:wrap;">
<button class="btn btnSecondary" data-profile-action="profile:customize" type="button">Open customize panel</button>
<button class="btn btnSecondary" data-profile-action="profile:themes" type="button">Themes</button>
</div>
</div>
<div class="panelBox profileEditSection" id="profileEditSection" style="display:none;">
<div id="myProfileEdit" style="display:none;">
<div class="sectionTitle">Edit my profile</div>
<div class="panelBox">
<div class="field">
<label>Avatar</label>
<input accept="image/*" id="avatarFile" type="file"/>
<div class="small">Max 5MB. PNG/JPG/WEBP/GIF.</div>
</div>
<div class="field" id="couplesField">
<label id="couplesLabel">Couples <span class="pillCount" id="couplesLabelBadge" style="display:none;"></span></label>
<div class="small">All couples features are opt-in and can be disabled at any time.</div>
<div class="row" style="margin-top:8px; gap:8px; align-items:center;">
<input id="couplesPartnerInput" placeholder="Partner username" style="flex:1;"/>
<button class="btn secondary" id="couplesRequestBtn" type="button">Send link request</button>
</div>
<div class="panelBox" id="couplesPendingBox" style="margin-top:10px; display:none;">
<div class="small" style="margin-bottom:6px;">Pending</div>
<div id="couplesPendingList"></div>
</div>
<div class="panelBox" id="couplesActiveBox" style="margin-top:10px; display:none;">
<div class="small" id="couplesActiveTitle">Linked</div>
<div class="row couplesStatusRow" style="margin-top:8px; gap:8px; align-items:center;">
<select aria-label="Couple status emoji" id="couplesStatusEmoji" style="width:72px;">
<option value="ğŸ’œ">ğŸ’œ</option>
<option value="ğŸ’•">ğŸ’•</option>
<option value="âœ¨">âœ¨</option>
<option value="ğŸ«¶">ğŸ«¶</option>
<option value="ğŸŒ™">ğŸŒ™</option>
<option value="ğŸ”¥">ğŸ”¥</option>
<option value="ğŸ§¸">ğŸ§¸</option>
</select>
<input id="couplesStatusLabel" maxlength="24" placeholder="Status label (e.g. Linked)" style="flex:1;"/>
<button class="btn secondary" id="couplesStatusSaveBtn" type="button">Save</button>
</div>
<div class="row couplesMoodRow" style="margin-top:8px; gap:8px; align-items:center;">
<select aria-label="Couple mood emoji" id="couplesMoodEmoji" style="width:72px;">
<option value="">â€”</option>
<option value="ğŸŒ™">ğŸŒ™</option>
<option value="ğŸ’«">ğŸ’«</option>
<option value="ğŸ§¸">ğŸ§¸</option>
<option value="â˜•">â˜•</option>
<option value="ğŸ”¥">ğŸ”¥</option>
<option value="ğŸ¥º">ğŸ¥º</option>
<option value="ğŸ«¶">ğŸ«¶</option>
<option value="ğŸ’œ">ğŸ’œ</option>
</select>
<div class="small" style="flex:1;">Shared mood (optional)</div>
<button class="btn secondary" id="couplesMoodSaveBtn" type="button">Save</button>
<button class="btn secondary" id="couplesPingBtn" type="button">Ping</button>
</div>
<div class="small">Shown as the couples badge (if enabled) and in your profile when both of you allow it.</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesEnabledToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable couples features</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesShowProfileToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Show link on profiles</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesBadgeToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Show badge (ğŸ’œ) in members list</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesAuraToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable shared aura when together</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesShowMembersToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Show link in members list</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesGroupToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Pull us together in members list</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesAllowPingToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Allow partner pings</div>
</div>
<div class="panelBox couplesV2Box" id="couplesV2Box" style="margin-top:12px; display:none;">
<div class="small">Couple card (shared settings)</div>
<div class="row" style="margin-top:8px; gap:8px; align-items:center;">
<select aria-label="Couple privacy" id="couplesPrivacySelect">
<option value="private">Private</option>
<option value="friends">Friends</option>
<option value="public">Public</option>
</select>
<input id="couplesNameInput" maxlength="48" placeholder="Couple name (optional)" style="flex:1;"/>
</div>
<textarea id="couplesBioInput" maxlength="220" placeholder="Couple bio (optional)" style="width:100%; min-height:70px; margin-top:8px;"></textarea>
<div class="toggleRow" style="margin-top:8px;">
<label class="switch">
<input id="couplesShowBadgeToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Show couple badge publicly</div>
</div>
<div class="toggleRow">
<label class="switch">
<input id="couplesBonusesToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable couple bonuses (tiny)</div>
</div>
<div class="row" style="margin-top:8px; gap:8px; align-items:center;">
<button class="btn secondary" id="couplesSettingsSaveBtn" type="button">Save couple card</button>
<button class="btn secondary" id="couplesNudgeBtn" type="button" aria-label="Nudge your partner">Nudge</button>
</div>
<div class="small" id="couplesV2Status" style="margin-top:6px;"></div>
</div>
<div class="row" style="margin-top:10px; gap:8px;">
<button class="btn danger" id="couplesUnlinkBtn" type="button">Unlink</button>
</div>
</div>
<div class="msgline" id="couplesMsg"></div>
</div>
<div class="field">
<label>Mood</label>
<input id="editMood" placeholder="e.g. chilling"/>
</div>
<div class="field">
<label>Username</label>
<input id="editUsername" placeholder="New username"/>
<div class="small">Changing your username costs 5,000 gold.</div>
<button class="btn secondary" id="changeUsernameBtn" type="button">Change username</button>
</div>
<div class="row">
<div class="field" style="flex:1;">
<label>Age (18+)</label>
<input id="editAge" max="120" min="18" placeholder="18+" type="number"/>
</div>
<div class="field" style="flex:1;">
<label>Gender</label>
<select id="editGender">
<option value="">Prefer not to say</option>
<option value="Male">Male</option>
<option value="Female">Female</option>
<option value="Non-binary">Non-binary</option>
<option value="Transgender">Transgender</option>
<option value="Genderfluid">Genderfluid</option>
<option value="Agender">Agender</option>
<option value="Other">Other</option>
</select>
</div>
</div>
<div class="field">
<label>Vibe tags (pick up to <span id="vibeTagLimit">3</span>)</label>
<div class="pillRow" id="vibeTagOptions"></div>
<div class="small">Adds a few personality badges to your profile.</div>
</div>
<div class="field">
<div class="fieldLabelRow">
<label>Bio (BBCode supported)</label>
<button class="pillBtn small" id="bioHelperToggle" type="button">BBCode help &amp; preview</button>
</div>
<textarea id="editBio" placeholder="[b]bold[/b] [i]italics[/i] [url=https://...]link[/url] [quote]...[/quote]"></textarea>
<div class="bioHelper" hidden="" id="bioHelper">
<div class="bioHelperRow" id="bioHelperButtons">
<button class="pillBtn tiny" data-bio-tag="b" type="button">[b][/b]</button>
<button class="pillBtn tiny" data-bio-tag="i" type="button">[i][/i]</button>
<button class="pillBtn tiny" data-bio-tag="u" type="button">[u][/u]</button>
<button class="pillBtn tiny" data-bio-tag="s" type="button">[s][/s]</button>
<button class="pillBtn tiny" data-bio-tag="quote" type="button">[quote][/quote]</button>
<button class="pillBtn tiny" data-bio-tag="code" type="button">[code][/code]</button>
<button class="pillBtn tiny" data-bio-tag="url" type="button">[url]</button>
<button class="pillBtn tiny" data-bio-tag="color" type="button">[color]</button>
<button class="pillBtn tiny" data-bio-tag="img" type="button">[img]</button>
</div>
<div class="bioHelperPreview" id="bioHelperPreview"></div>
<div class="small muted">Use BBCode for simple formatting. Links/images require full URLs.</div>
</div>
</div>
<div class="panelBox" id="memorySettingsPanel" style="display:none;">
<div class="sectionTitle">Memory &amp; Lore System</div>
<div class="toggleRow">
<label class="switch">
<input id="memoryEnabledToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable Memory Timeline</div>
</div>
<div class="small muted">Unlock memory cards and your profile timeline (Owner only during early rollout).</div>
<div class="msgline" id="memorySettingsMsg"></div>
</div>
<div class="row">
<button class="btn btnPrimary" id="saveProfileBtn" type="button">Save</button>
<button class="btn btnSecondary" id="refreshProfileBtn" type="button">Cancel</button>
<button class="btn btnDanger" id="logoutBtn" type="button">Logout</button>
</div>
<div class="msgline" id="profileMsg"></div>
</div>
</div>
</div>
</details>
<details class="profileSection" data-section="moderation" id="profileModerationSection" style="display:none;">
<summary>Moderation</summary>
<div class="profileSectionBody">
<div class="panelBox">
<div class="small">Moderator tools for this member.</div>
<div class="row" style="margin-top:10px; gap:8px; flex-wrap:wrap;">
<button class="btn btnSecondary" data-profile-action="profile:moderation" id="profileModerationOpenBtn" type="button">Open moderation panel</button>
</div>
</div>
</div>
</details>
</div>
</div>
<div id="viewTimeline" style="display:none;">
<div class="memoryTimeline">
<div class="memoryFilters" id="memoryFilterBar">
<div class="memoryFilterRow">
<button class="memoryFilterChip active" data-filter="all" type="button">All</button>
<button class="memoryFilterChip" data-filter="social" type="button">Social</button>
<button class="memoryFilterChip" data-filter="progress" type="button">Progress</button>
<button class="memoryFilterChip" data-filter="media" type="button">Media</button>
<button class="memoryFilterChip" data-filter="rooms" type="button">Rooms</button>
<button class="memoryFilterChip" data-filter="rare" type="button">Rare</button>
</div>
</div>
<div class="memoryFeatured" id="memoryFeaturedSection" style="display:none;">
<div class="sectionTitle">Featured Memories</div>
<div class="memoryFeaturedRow" id="memoryFeaturedRow"></div>
</div>
<div class="memoryTimelineList" id="memoryTimelineList"></div>
<div class="memoryEmptyState" id="memoryEmptyState" style="display:none;">
<div class="panelBox">
<div class="sectionTitle">No memories yet</div>
<div class="small muted">Your timeline will capture milestones like your first voice note, image upload, and level ups.</div>
</div>
</div>
<div class="msgline" id="memoryTimelineMsg"></div>
</div>
</div>
<div id="viewCustomize" style="display:none;">
<div class="profileCustomEmpty" id="profileCustomEmpty" style="display:none;">
<div class="panelBox">
<div class="small">Customisation settings are only available on your own profile.</div>
</div>
</div>
<div class="customizeShell" id="customizeShell">
<div class="customizeTopBar">
<div class="customizeSearchWrap"><input id="customizeSearch" placeholder="Search settingsâ€¦" type="search"/></div>
</div>
<div class="customizeCardGrid" id="customizeCardGrid">
<button class="customizeCard" data-category="chat" data-search="chat appearance message layout colors spacing text identity font username color readability" type="button">
<div class="cardTitle">Chat &amp; Identity</div>
<div class="cardHint">Message layout, fonts, name styling, and message text.</div>
<div class="cardPreview chatPreview"></div>
</button>

<button class="customizeCard" data-category="themes" data-search="themes appearance color palette mode light dark" id="openThemesModalBtn" type="button">
<div class="cardTitle">Themes</div>
<div class="cardHint">Choose a theme for chat and profiles.</div>
<div class="cardPreview themesPreview"></div>
</button>

<button class="customizeCard" data-category="profile" data-search="profile appearance header gradient avatar aura" type="button">
<div class="cardTitle">Profile Appearance</div>
<div class="cardHint">Header gradient and aura options.</div>
<div class="cardPreview profilePreview"></div>
</button>
<button class="customizeCard" data-category="effects" data-search="effects animations polish comfort" type="button">
<div class="cardTitle">Effects</div>
<div class="cardHint">Animation toggles and effect presets.</div>
<div class="cardPreview effectsPreview"></div>
</button>
<button class="customizeCard" data-category="layout" data-search="layout accessibility scale contrast" type="button">
<div class="cardTitle">Layout &amp; Accessibility</div>
<div class="cardHint">Scaling, clarity, and motion controls.</div>
<div class="cardPreview layoutPreview"></div>
</button>
<button class="customizeCard" data-category="advanced" data-search="advanced debug experimental sound" type="button">
<div class="cardTitle">Advanced</div>
<div class="cardHint">Sound cues, diagnostics, and extras.</div>
<div class="cardPreview advancedPreview"></div>
</button>
</div>
<div class="customizeSubpages" id="customizeSubpages">
<div class="customizeSubpage" data-category="chat" id="customizeChatPage">
<div class="customizeHeader">
<button aria-label="Back" class="iconBtn customizeBackBtn" data-back="chat" type="button">â†</button>
<div>
<div class="title">Chat &amp; Identity</div>
<div class="small muted">Message layout, fonts, and readability.</div>
</div>
</div>
<div class="customizeChatLayout">
<aside class="customizeChatPreview">
<div class="chatFxPreviewWrap">
<div class="small" style="margin-bottom:10px;">Preview your chat appearance before saving.</div>
<div class="chatFxPreview chat-main" id="chatFxPreview">
<div class="chatFxPreviewRow self">
<div class="msgItem msg--main self chatFxPreviewItem">
<div class="msgAvatar chatFxPreviewAvatar" id="chatFxPreviewAvatar"></div>
<div class="msgMain">
<div class="bubble chatFxPreviewBubble" id="chatFxPreviewBubble">
<div class="meta">
<div class="name">
<span class="roleIco" id="chatFxPreviewRoleIcon">ğŸ‘‘ </span>
<span class="unameText" id="chatFxPreviewName">You</span>
</div>
<div class="time" id="chatFxPreviewTime">Just now</div>
</div>
<div class="text" id="chatFxPreviewText">Your message preview.</div>
</div>
</div>
</div>
</div>
</div>
<div class="chatFxActions">
<div class="chatFxStatus" id="chatFxStatus"></div>
<button class="btn" id="chatFxSaveBtn" type="button">Save appearance</button>
</div>
</div>
</aside>
<div class="customizeChatControls">
<div class="customizeSection">
<div class="sectionTitle">Message Layout</div>
<div class="panelBox" id="messageLayoutControls">
<div class="field" data-customize-item="" data-search="message density spacing compact comfortable">
<label for="msgDensitySelect">Message density</label>
<select id="msgDensitySelect">
<option value="compact">Compact</option>
<option value="medium">Medium</option>
<option value="comfortable">Comfortable</option>
</select>
<div class="small muted">Adjust padding and gap between messages.</div>
</div>
<div class="field" data-customize-item="" data-search="accent line style border">
<label for="msgAccentStyleSelect">Accent line style</label>
<select id="msgAccentStyleSelect">
<option value="solid">Solid</option>
<option value="dotted">Dotted</option>
<option value="gradient">Subtle gradient</option>
<option value="hoverGlow">Hover glow</option>
</select>
<div class="small muted">Left rail detail for each message block.</div>
</div>
<div class="field" data-customize-item="" data-search="username emphasis bold underline role chip">
<label for="msgUsernameEmphasisSelect">Username emphasis</label>
<select id="msgUsernameEmphasisSelect">
<option value="normal">Normal</option>
<option value="bold">Bold</option>
<option value="underlineHover">Underline-on-hover</option>
<option value="roleChip">Role-chip</option>
</select>
<div class="small muted">Pick how names stand out in chat.</div>
</div>
<div class="field" data-customize-item="" data-search="system message density compact minimized">
<label for="sysMsgDensitySelect">System message density</label>
<select id="sysMsgDensitySelect">
<option value="full">Full</option>
<option value="compact">Compact</option>
<option value="minimized">Minimized</option>
</select>
<div class="small muted">Tighten system message padding and size.</div>
</div>
<div class="field" data-customize-item="" data-search="message background contrast">
<label for="msgContrastSelect">Message background contrast</label>
<select id="msgContrastSelect">
<option value="low">Low</option>
<option value="medium">Medium</option>
<option value="high">High</option>
</select>
<div class="small muted">Control the block tint behind messages.</div>
</div>
</div>
</div>
<div class="customizeResetRow">
<button class="btn secondary" id="resetMessageLayoutBtn" type="button">Reset message layout</button>
</div>
</div>
</div>
<section class="customizeMergedSection" id="mergedTextIdentitySection">
<div class="customizeSectionTitle">Text &amp; Identity</div>
<div class="panelBox textStyleLaunch" data-customize-item="" data-search="text customisation neon gradient font style">
<div class="textStyleLaunchMeta">
<div class="textStyleLaunchLabel">Text Customisation</div>
<div class="textStyleLaunchValue">Style your username and message text separately with color, neon, gradients, and fonts.</div>
</div>
<div class="textStyleLaunchActions">
<button class="btn btnSecondary" id="openUsernameCustomizationBtn" type="button">Username Customisation</button>
<button class="btn btnSecondary" id="openMessageCustomizationBtn" type="button">Message Text Customisation</button>
</div>
</div>
</section></div>

<div class="customizeSubpage" data-category="profile" id="customizeProfilePage">
<div class="customizeHeader">
<button aria-label="Back" class="iconBtn customizeBackBtn" data-back="profile" type="button">â†</button>
<div>
<div class="title">Profile Appearance</div>
<div class="small muted">Header gradient and avatar accents.</div>
</div>
</div>
<div class="customizeSection">
<div class="sectionTitle">Basic</div>
<div class="panelBox" id="profileAppearanceBasic">
<div class="field" data-customize-item="" data-search="header gradient">
<label>Header gradient</label>
<div class="colorInputRow tight">
<input aria-label="Header color A" id="headerColorA" type="color"/>
<input aria-label="Header color A text" id="headerColorAText" placeholder="#ff6a2b" type="text"/>
</div>
<div class="colorInputRow tight" style="margin-top:6px;">
<input aria-label="Header color B" id="headerColorB" type="color"/>
<input aria-label="Header color B text" id="headerColorBText" placeholder="#2b0f08" type="text"/>
</div>
<div class="small">Pick two colors for your profile header gradient.</div>
</div>
<div class="field" data-customize-item="" data-search="avatar aura">
<div class="toggleRow">
<label class="switch">
<input id="chatFxPolishAuras" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Avatar aura</div>
</div>
<div class="small muted">Requires Polish Pack.</div>
</div>
</div>
</div>
<details class="customizeSection" data-section="profile-advanced">
<summary>Advanced</summary>
<div class="panelBox" id="profileAppearanceAdvanced">
<div class="field" data-customize-item="" data-search="accent color">
<label>Profile accent color</label>
<input id="chatFxAccent" placeholder="#RRGGBB" type="text"/>
<div class="small">Leave blank to keep your theme accent.</div>
</div>
</div>
</details>
<div class="customizeResetRow">
<button class="btn secondary" id="resetProfileAppearanceBtn" type="button">Reset this section</button>
</div>
</div>
<div class="customizeSubpage" data-category="effects" id="customizeEffectsPage">
<div class="customizeHeader">
<button aria-label="Back" class="iconBtn customizeBackBtn" data-back="effects" type="button">â†</button>
<div>
<div class="title">Effects</div>
<div class="small muted">Animation and polish options.</div>
</div>
</div>
<div class="customizeSection">
<div class="sectionTitle">Basic</div>
<div class="panelBox" id="effectsBasic">
<div class="field" data-customize-item="" data-search="animations">
<div class="toggleRow">
<label class="switch">
<input id="chatFxPolishAnimations" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Animations</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="comfort mode">
<div class="toggleRow">
<label class="switch">
<input id="prefComfortMode" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Comfort mode</div>
</div>
<div class="small muted" id="prefComfortHelp">Softens glows, confetti, and motion-heavy animations.</div>
</div>
<div class="field" data-customize-item="" data-search="preset">
<label>Effect preset</label>
<select id="effectsPreset">
<option value="">Custom</option>
<option value="soft">Soft</option>
<option value="neon">Neon</option>
<option value="minimal">Minimal</option>
</select>
</div>
</div>
</div>
<details class="customizeSection" data-section="effects-advanced">
<summary>Advanced</summary>
<div class="panelBox" id="effectsAdvanced">
<div class="field" data-customize-item="" data-search="polish pack">
<div class="toggleRow">
<label class="switch">
<input id="chatFxPolishPack" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable Polish Pack</div>
</div>
</div>
</div>
</details>
<div class="customizeResetRow">
<button class="btn secondary" id="resetEffectsBtn" type="button">Reset this section</button>
</div>
</div>
<div class="customizeSubpage" data-category="layout" id="customizeLayoutPage">
<div class="customizeHeader">
<button aria-label="Back" class="iconBtn customizeBackBtn" data-back="layout" type="button">â†</button>
<div>
<div class="title">Layout &amp; Accessibility</div>
<div class="small muted">Scale, clarity, and motion overrides.</div>
</div>
</div>
<div class="customizeSection">
<div class="sectionTitle">Basic</div>
<div class="panelBox" id="layoutBasic">
<div class="field" data-customize-item="" data-search="ui scale">
<label>UI scale</label>
<div class="uiScaleRow">
<input aria-label="UI size" id="uiScaleRange" max="1.05" min="0.80" step="0.05" type="range" value="1"/>
<div class="small muted" id="uiScaleValue">100%</div>
</div>
<div class="uiScaleActions">
<button class="btn secondary" id="uiScaleResetBtn" type="button">Auto</button>
</div>
</div>
</div>
</div>
<details class="customizeSection" data-section="layout-advanced">
<summary>Advanced</summary>
<div class="panelBox" id="layoutAdvanced">
<div class="field" data-customize-item="" data-search="reduced motion">
<div class="toggleRow">
<label class="switch">
<input id="reduceMotionToggle" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Reduced motion override</div>
</div>
<div class="small muted">Mirrors your comfort mode preference.</div>
</div>
</div>
</details>
<div class="customizeResetRow">
<button class="btn secondary" id="resetLayoutBtn" type="button">Reset this section</button>
</div>
</div>
<div class="customizeSubpage" data-category="advanced" id="customizeAdvancedPage">
<div class="customizeHeader">
<button aria-label="Back" class="iconBtn customizeBackBtn" data-back="advanced" type="button">â†</button>
<div>
<div class="title">Advanced</div>
<div class="small muted">Sound cues, diagnostics, and extras.</div>
</div>
</div>
<div class="customizeSection">
<div class="sectionTitle">Basic</div>
<div class="panelBox" id="advancedBasic">
<div class="field" data-customize-item="" data-search="sound cues">
<div class="small" style="margin-bottom:10px;">Sound cues are quiet and optional. On iOS you may need to toggle once to enable audio.</div>
<div class="toggleRow">
<label class="switch">
<input id="prefSoundEnabled" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Enable sound cues</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="room messages sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundRoom" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Room messages</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="direct messages sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundDm" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Direct messages</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="mentions sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundMention" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Mentions (@you)</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="message sent sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundSent" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Message sent</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="message received sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundReceive" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Message received</div>
</div>
</div>
<div class="field" data-customize-item="" data-search="reaction sound">
<div class="toggleRow">
<label class="switch">
<input id="prefSoundReaction" type="checkbox"/>
<span class="slider"></span>
</label>
<div class="toggleLabel">Reaction added</div>
</div>
</div>
<div class="small" id="prefSoundStatus" style="margin-top:8px;"></div>
</div>
</div>
<details class="customizeSection" data-section="advanced-extra">
<summary>Advanced</summary>
<div class="panelBox" id="advancedAdvanced">
<div class="field" data-customize-item="" data-search="dm neon backing">
<div class="small">DM neon backing</div>
<div class="colorInputRow tight">
<input aria-label="DM neon backing color" id="dmNeonColor" type="color"/>
<input aria-label="DM neon backing color text" id="dmNeonColorText" placeholder="#5865f2 or blue" type="text"/>
</div>
<div class="small">Adds a subtle neon outline around your DM panel. DM background follows your current theme.</div>
</div>
<div class="field" data-customize-item="" data-search="dm badge color">
<label>Direct message badge color</label>
<div class="colorInputRow">
<input aria-label="Direct message badge color" id="directBadgeColor" type="color"/>
<input aria-label="Direct message badge color text" id="directBadgeColorText" placeholder="#ed4245 or red" type="text"/>
</div>
</div>
<div class="field" data-customize-item="" data-search="group dm badge color">
<label>Group DM badge color</label>
<div class="colorInputRow">
<input aria-label="Group DM badge color" id="groupBadgeColor" type="color"/>
<input aria-label="Group DM badge color text" id="groupBadgeColorText" placeholder="#5865f2 or blue" type="text"/>
</div>
</div>
<div class="row" style="margin-top:6px;">
<button class="btn btnPrimary" id="saveBadgePrefsBtn" type="button">Save badge colors</button>
</div>
<div class="msgline" id="customizeMsg"></div>
<div class="sectionTitle" style="margin-top:16px;">VIP gifts</div>
<div class="panelBox">
<div class="small">This section is wired and ready â€” add your gifts system whenever you want.</div>
<div class="small" style="margin-top:6px;">Tip: later load inventory/history via an endpoint like <code>/gifts</code> and render it here.</div>
</div>
</div>
</details>
<div class="customizeResetRow">
<button class="btn secondary" id="resetAdvancedBtn" type="button">Reset this section</button>
</div>
</div>
</div>
</div>
</div>
<div id="viewActions" style="display:none;">
<div class="sectionTitle">Quick actions</div>
<div class="panelBox actionList">
<button class="btn secondary" id="actionMuteBtn" type="button">Mute</button>
<button class="btn secondary" id="actionKickBtn" type="button">Kick</button>
<button class="btn danger" id="actionBanBtn" type="button">Ban</button>
<button class="btn secondary" id="actionAppealsBtn" type="button">View appeals</button>
</div>
<div id="viewModeration">
<div class="sectionTitle">Moderation panel</div>
<div class="panelBox modCard">
<div class="field">
<label>Target</label>
<select id="modUserSelect"></select>
<input autocomplete="off" id="modUser" placeholder="Search or type username"/>
<div class="row modTargetActions" style="gap:8px; flex-wrap:wrap;">
<button class="btn secondary" id="modOpenProfileBtn" type="button">View profile</button>
<button class="btn secondary" id="modRefreshTargetsBtn" type="button">Refresh list</button>
</div>
</div>
<div class="field">
<label>Reason</label>
<div class="pillRow" id="modReasonPresets"></div>
<textarea id="modReason" placeholder="Choose a preset and add details (required)" rows="2"></textarea>
</div>
<div class="modGrid">
<div class="field">
<label>Mute length</label>
<select id="modMuteMins">
<option value="10">10 minutes</option>
<option value="30">30 minutes</option>
<option value="60">1 hour</option>
<option value="240">4 hours</option>
<option value="1440">24 hours</option>
</select>
</div>
<div class="field">
<label>Ban length</label>
<select id="modBanMins">
<option value="0">Permanent</option>
<option value="60">1 hour</option>
<option value="720">12 hours</option>
<option value="1440">24 hours</option>
<option value="10080">7 days</option>
</select>
</div>
</div>
<div class="actionGrid" style="margin-top:8px;">
<button class="btn btnSecondary" id="modKickBtn" type="button">Kick</button>
<button class="btn btnSecondary" id="modWarnBtn" type="button">Warn</button>
<button class="btn btnSecondary" id="modMuteBtn" type="button">Mute</button>
<button class="btn btnDanger" id="modBanBtn" type="button">Ban</button>
<button class="btn btnSecondary" id="modUnmuteBtn" type="button">Unmute</button>
<button class="btn btnSecondary" id="modUnbanBtn" type="button">Unban</button>
</div>
<div class="field" style="margin-top:8px;">
<label>Role assignment</label>
<div class="row" style="gap:8px; flex-wrap:wrap;">
<select id="modSetRole">
<option value="">Set role (Owner only)</option>
<option>Owner</option>
<option>Co-owner</option>
<option>Admin</option>
<option>Moderator</option>
<option>VIP</option>
<option>User</option>
<option>Guest</option>
</select>
<button class="btn btnPrimary" id="modSetRoleBtn" type="button">Apply role</button>
</div>
</div>
<div class="msgline" id="modMsg"></div>
</div>
<div class="sectionTitle">Moderation logs</div>
<div class="panelBox">
<div class="row" style="align-items:center;">
<input id="logUser" placeholder="Filter by user (actor or target)" style="flex:1; min-width:220px;"/>
<select id="logAction" style="width:220px;">
<option value="">All actions</option>
<option value="KICK">KICK</option>
<option value="MUTE">MUTE</option>
<option value="BAN">BAN</option>
<option value="DELETE_MESSAGE">DELETE_MESSAGE</option>
<option value="UNMUTE">UNMUTE</option>
<option value="UNBAN">UNBAN</option>
<option value="WARN">WARN</option>
<option value="SET_ROLE">SET_ROLE</option>
</select>
<select id="logLimit" style="width:160px;">
<option value="25">Last 25</option>
<option selected="" value="50">Last 50</option>
<option value="100">Last 100</option>
<option value="200">Last 200</option>
</select>
<button class="btn secondary" id="refreshLogsBtn" type="button">Refresh</button>
</div>
<div class="msgline" id="logsMsg"></div>
<div class="logTableWrap">
<table class="logTable">
<thead>
<tr>
<th>Time</th>
<th>Actor</th>
<th>Action</th>
<th>Target</th>
<th>Room</th>
<th>Details</th>
</tr>
</thead>
<tbody id="logsBody"></tbody>
</table>
</div>
</div>
</div>
</div>
<!-- Quick Actions overlay (staff) -->
<div class="inlineModalOverlay" id="inlineMemberActionsShade" style="display:none;">
<div class="inlineModalCard">
<div id="memberActionsOverlay" style="display:none;">
<div class="inlineModalHeader"><div class="sectionTitle" style="margin:0;">Actions</div><button aria-label="Close" class="iconBtn" id="closeMemberActionsBtn" type="button">âœ•</button></div>
<div class="panelBox modCard">
<div class="field">
<label>Reason</label>
<div class="pillRow" id="quickReasonPresets"></div>
<textarea id="quickReason" placeholder="Add context (required)" rows="2"></textarea>
</div>
<div class="modGrid">
<div class="field">
<label>Kick length</label>
<select id="quickKickSeconds">
<option value="60">1 minute</option>
<option selected="" value="300">5 minutes</option>
<option value="900">15 minutes</option>
<option value="3600">1 hour</option>
<option value="21600">6 hours</option>
<option value="86400">24 hours</option>
<option value="604800">1 week</option>
</select>
</div>
<div class="field">
<label>Mute length</label>
<select id="quickMuteMins">
<option value="10">10 minutes</option>
<option value="30">30 minutes</option>
<option value="60">1 hour</option>
<option value="240">4 hours</option>
<option value="1440">24 hours</option>
</select>
</div>
<div class="field">
<label>Ban length</label>
<select id="quickBanMins">
<option value="0">Permanent</option>
<option value="60">1 hour</option>
<option value="720">12 hours</option>
<option value="1440">24 hours</option>
<option value="10080">7 days</option>
</select>
</div>
</div>
<div class="actionGrid" style="margin-top:8px;">
<button class="btn btnSecondary" id="quickKickBtn" type="button">Kick</button>
<button class="btn btnSecondary" id="quickUnkickBtn" type="button">Unkick</button>
<button class="btn btnSecondary" id="quickMuteBtn" type="button">Mute</button>
<button class="btn btnSecondary" id="quickUnmuteBtn" type="button">Unmute</button>
<button class="btn btnDanger" id="quickBanBtn" type="button">Ban</button>
</div>
<div class="msgline" id="quickModMsg"></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- COUPLES POPOUT MODAL -->
<!-- Hidden by default; JS will toggle display + [hidden] when opened. -->
<div id="couplesModal" aria-hidden="true" hidden>
  <div class="modalCard couplesModalCard">
    <div class="modalTop">
      <strong>Couples</strong>
      <button class="iconBtn" id="couplesModalClose" type="button" title="Close">âœ•</button>
    </div>
    <div class="modalBody" id="couplesModalBody"></div>
  </div>
</div>

<div class="themesModal" id="themesModal" aria-hidden="true">
  <div class="themesModalCard" role="dialog" aria-modal="true" aria-label="Themes">
    <div class="themesModalSticky">
      <div class="themesModalHeader">
        <div class="themesModalTitle">Themes</div>
        <button class="iconBtn" id="themesModalClose" type="button" aria-label="Close themes">âœ•</button>
      </div>
      <div class="themeLaunchRow">
        <div class="themeLaunchMeta">
          <div class="themeLaunchLabel">Current theme</div>
          <div class="themeLaunchValue" id="currentThemeLabel">â€”</div>
        </div>
        <button class="btn secondary" id="themesFiltersBtn" type="button">Filters</button>
      </div>
      <div class="themesModalSearchRow">
        <input id="themesModalSearch" placeholder="Search themes..." type="search"/>
        <select id="themesModalSort">
          <option value="recents">Recents</option>
          <option value="newest">Newest</option>
          <option value="az">A â†’ Z</option>
          <option value="favorites">Favorites</option>
          <option value="pinned">Pinned</option>
        </select>
      </div>
      <div class="themesModalFilters" id="themesModalFilters"></div>
    </div>
    <div class="themesModalBody">
      <div class="themesListPane">
        <section id="themesPinnedSection">
          <div class="themesSectionHeader">Pinned themes</div>
          <div class="themesGrid" id="themesPinnedGrid"></div>
        </section>
        <section>
          <div class="themesSectionHeader">All themes</div>
          <div class="themesGrid" id="themesAllGrid"></div>
          <div class="themesEmpty" id="themesEmptyState">No themes match that search.</div>
          <div class="msgline" id="themeMsg"></div>
        </section>
      </div>
      <aside class="themesPreviewPane">
        <div class="themesPreviewCard">
          <div class="themesPreviewHeader">
            <div class="themesPreviewTitle">Preview</div>
            <div class="themesPreviewName" id="themesPreviewName">â€”</div>
          </div>
          <div class="themesPreviewFrame" id="themesPreviewFrame">
            <div class="themesPreviewTopbar">Chat preview</div>
            <div class="themesPreviewChat">
              <div class="themesPreviewMsg">
                <div class="themesPreviewAvatar"></div>
                <div class="themesPreviewBubble">Hey there!</div>
              </div>
              <div class="themesPreviewMsg self">
                <div class="themesPreviewAvatar"></div>
                <div class="themesPreviewBubble">All set?</div>
              </div>
            </div>
            <div class="themesPreviewComposer">
              <input class="themesPreviewInput" type="text" value="Message..." readonly/>
              <button class="themesPreviewSend" type="button">Send</button>
            </div>
          </div>
          <div class="themesPreviewActions">
            <button class="btn btnPrimary" id="themesApplyBtn" type="button">Apply theme</button>
            <button class="btn secondary" id="themesBuyBtn" type="button">Buy for 0 Gold</button>
            <div class="themesPreviewHint small muted" id="themesPreviewHint"></div>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>

<div class="themesFiltersSheet" id="themesFiltersSheet" aria-hidden="true">
  <div class="themesFiltersSheetCard">
    <div class="themesFiltersSheetHeader">
      <div>Filters</div>
      <button class="iconBtn" id="themesFiltersSheetClose" type="button" aria-label="Close filters">âœ•</button>
    </div>
    <div class="themesFiltersSheetBody" id="themesFiltersSheetBody"></div>
  </div>
</div>

<div class="themesActionSheet" id="themesActionSheet" aria-hidden="true">
  <div class="themesActionSheetCard">
    <div class="themesActionSheetTitle">
      <div id="themesActionSheetTitle">Theme</div>
      <button class="iconBtn" id="themesActionCloseBtn" type="button" aria-label="Close theme actions">âœ•</button>
    </div>
    <button class="btn secondary" id="themesActionPinBtn" type="button">Pin theme</button>
    <button class="btn secondary" id="themesActionFavoriteBtn" type="button">Favorite</button>
    <button class="btn btnPrimary" id="themesActionApplyBtn" type="button">Apply theme</button>
    <button class="btn secondary" id="themesActionBuyBtn" type="button">Buy for 0 Gold</button>
  </div>
</div>

<div class="mediaLightbox" id="mediaLightbox">
<button aria-label="Close media" class="iconBtn largeClose" id="mediaLightboxClose" type="button">âœ•</button>
<img alt="Expanded media" id="mediaLightboxImg"/>
<video controls="" id="mediaLightboxVideo" playsinline=""></video>
</div>
</div>
<script src="/socket.io/socket.io.js"></script>
<script src="https://unpkg.com/wavesurfer.js@7/dist/wavesurfer.min.js"></script>
<script defer="" src="/app.js"></script>
<div id="modalRoot">
<!-- STAFF: Kick/Ban Appeals Panel -->
<div class="appealsPanel" hidden="" id="appealsPanel">
<div class="appealsPanelHeader">
<div>
<div class="title">Appeals</div>
<div class="small muted">Open tickets from kicked/banned users.</div>
</div>
<button class="iconBtn" id="appealsCloseBtn" title="Close" type="button">âœ•</button>
</div>
<div class="appealsPanelBody">
<div class="appealsList" id="appealsList"></div>
<div class="appealsDetail" hidden="" id="appealsDetail">
<div class="appealsDetailTop">
<div class="appealsDetailUser">
<div class="title" id="appealsDetailUser">â€”</div>
<div class="small muted" id="appealsDetailMeta">â€”</div>
</div>
<button class="btn secondary" id="appealsBackBtn" type="button">Back</button>
</div>
<div class="card">
<div class="small muted">Restriction reason</div>
<div id="appealsDetailReason" style="margin-top:6px;"></div>
</div>
<div class="card">
<div class="title">Moderation logs</div>
<div class="appealsModlogs" id="appealsModlogs"></div>
</div>
<div class="card">
<div class="title">Ticket</div>
<div class="appealThread staffThread" id="appealsThread"></div>
<textarea id="appealsReplyInput" maxlength="2000" placeholder="Reply as staff..." rows="3"></textarea>
<div class="row" style="gap:10px; flex-wrap:wrap; margin-top:10px;">
<button class="btn" id="appealsReplyBtn" type="button">Send reply</button>
<div class="msgline" id="appealsReplyMsg"></div>
</div>
</div>
<div class="card">
<div class="title">Actions</div>
<div class="row" style="gap:10px; flex-wrap:wrap; align-items:center;">
<label class="small muted">Kick duration</label>
<select id="appealsDurationSelect"></select>
<button class="btn secondary" id="appealsBanToKickBtn" type="button">Ban â†’ Kick</button>
<button class="btn secondary" id="appealsUpdateKickBtn" type="button">Update kick</button>
<button class="btn danger" id="appealsUnlockBtn" type="button">Unban / Unlock</button>
</div>
</div>
</div>
</div>
</div>
<!-- STAFF: Referrals Panel -->
<div class="referralsPanel" hidden="" id="referralsPanel">
<div class="appealsPanelHeader">
<div>
<div class="title">Referrals</div>
<div class="small muted">Moderator requests for admin review.</div>
</div>
<div class="appealsPanelHeaderActions">
<button class="btn secondary small" id="referralsRefreshBtn" type="button">Refresh</button>
<button class="iconBtn" id="referralsCloseBtn" title="Close" type="button">âœ•</button>
</div>
</div>
<div class="appealsPanelBody">
<div class="appealsSplit">
<div class="appealsList" id="referralsList"></div>
<div class="appealsDetail" id="referralsDetail">
<div class="card">
<div class="title" id="referralsDetailUser">Select a referral</div>
<div class="small muted" id="referralsDetailMeta"></div>
</div>
<div class="card">
<div class="small muted">Reason</div>
<div id="referralsDetailReason" style="margin-top:6px;"></div>
</div>
<div class="card">
<div class="title">Actions</div>
<div class="small muted" style="margin-bottom:10px;">Resolve the referral once handled.</div>
<div style="display:flex; gap:10px; flex-wrap:wrap;">
<button class="btn secondary small" id="referralsCopyUserBtn" type="button">Copy username</button>
<button class="btn secondary small" id="referralsMarkDoneBtn" type="button">Mark done</button>
</div>
<div class="msgline" id="referralsActionMsg" style="margin-top:8px;"></div>
</div>
</div>
</div>
</div>
</div>
<!-- STAFF: Cases Panel -->
<div class="appealsPanel" hidden="" id="casesPanel">
<div class="appealsPanelHeader">
<div>
<div class="title">Cases</div>
<div class="small muted">Unified moderation cases (flags, appeals, referrals).</div>
</div>
<div class="appealsPanelHeaderActions">
<select class="select small" id="casesFilterStatus">
<option value="">All statuses</option>
<option value="open">Open</option>
<option value="pending">Pending</option>
<option value="resolved">Resolved</option>
<option value="closed">Closed</option>
</select>
<select class="select small" id="casesFilterType">
<option value="">All types</option>
<option value="flag">Flag</option>
<option value="appeal">Appeal</option>
<option value="referral">Referral</option>
<option value="investigation">Investigation</option>
</select>
<select class="select small" id="casesFilterAssigned">
<option value="">All assignments</option>
<option value="me">Assigned to me</option>
<option value="unassigned">Unassigned</option>
</select>
<button class="btn secondary small" id="casesRefreshBtn" type="button">Refresh</button>
<button class="iconBtn" id="casesCloseBtn" title="Close" type="button">âœ•</button>
</div>
</div>
<div class="appealsPanelBody">
<div class="appealsSplit">
<div class="appealsList" id="casesList"></div>
<div class="appealsDetail" id="casesDetail" hidden="">
<div class="card">
<div class="title" id="casesDetailTitle">Select a case</div>
<div class="small muted" id="casesDetailMeta"></div>
</div>
<div class="card">
<div class="small muted">Summary</div>
<div id="casesDetailSummary" style="margin-top:6px;"></div>
</div>
<div class="card">
<div class="title">Assignment &amp; status</div>
<div class="row" style="gap:10px; flex-wrap:wrap;">
<select id="casesStatusSelect">
<option value="open">Open</option>
<option value="pending">Pending</option>
<option value="resolved">Resolved</option>
<option value="closed">Closed</option>
</select>
<input class="input" id="casesAssignInput" placeholder="Assign to user IDâ€¦" style="max-width:160px;"/>
<button class="btn secondary" id="casesAssignBtn" type="button">Assign</button>
<button class="btn secondary" id="casesStatusBtn" type="button">Update status</button>
</div>
<div class="msgline" id="casesActionMsg" style="margin-top:8px;"></div>
</div>
<div class="card">
<div class="title">Notes</div>
<div id="casesNotes"></div>
<textarea id="casesNoteInput" maxlength="2000" placeholder="Add a noteâ€¦" rows="3"></textarea>
<div class="row" style="gap:10px; flex-wrap:wrap; margin-top:10px;">
<button class="btn" id="casesNoteBtn" type="button">Add note</button>
</div>
</div>
<div class="card">
<div class="title">Evidence</div>
<div id="casesEvidence"></div>
<div class="row" style="gap:10px; flex-wrap:wrap;">
<select id="casesEvidenceType">
<option value="text">Text</option>
<option value="link">Link</option>
<option value="message">Message</option>
</select>
<input class="input" id="casesEvidenceUrl" placeholder="URL (optional)" style="max-width:200px;"/>
<input class="input" id="casesEvidenceMessageId" placeholder="Message ID" style="max-width:140px;"/>
</div>
<textarea id="casesEvidenceText" maxlength="2000" placeholder="Evidence detailsâ€¦" rows="2"></textarea>
<div class="row" style="gap:10px; flex-wrap:wrap; margin-top:10px;">
<button class="btn" id="casesEvidenceBtn" type="button">Add evidence</button>
</div>
</div>
<div class="card">
<div class="title">Timeline</div>
<div id="casesTimeline"></div>
</div>
</div>
</div>
</div>
</div>
<!-- STAFF: Role Debug Panel -->
<div class="roleDebugPanel" hidden="" id="roleDebugPanel">
<div class="appealsPanelHeader">
<div>
<div class="title">Role debug</div>
<div class="small muted">Quickly set a user's role (Owner/Co-Owner/Admin/Moderator/VIP/User/Guest).</div>
</div>
<div class="appealsPanelHeaderActions">
<button class="iconBtn" id="roleDebugCloseBtn" title="Close" type="button">âœ•</button>
</div>
</div>
<div class="appealsPanelBody">
<div class="card">
<div class="small muted">Target user</div>
<input autocomplete="off" class="input" id="roleDebugTarget" placeholder="username" style="margin-top:6px;"/>
<div class="small muted" style="margin-top:10px;">Role</div>
<select class="select" id="roleDebugRole" style="margin-top:6px;">
<option value="">Choose roleâ€¦</option>
<option>Owner</option>
<option>Co-owner</option>
<option>Admin</option>
<option>Moderator</option>
<option>VIP</option>
<option>User</option>
<option>Guest</option>
</select>
<div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
<button class="btn btnPrimary" id="roleDebugApplyBtn" type="button">Apply</button>
<button class="btn btnSecondary" id="roleDebugUseSelectedBtn" type="button">Use selected member</button>
</div>
<div class="msgline" id="roleDebugMsg" style="margin-top:8px;"></div>
</div>
<div class="card">
<div class="title">Tip</div>
<div class="small muted">This uses the same server-side permissions as normal moderation tools, so only authorized roles can make changes.</div>
</div>
</div>
</div>
<!-- START: Owner Feature Flags Panel -->
<div class="ownerPanel" hidden="" id="featureFlagsPanel">
  <div class="ownerPanelHeader">
    <div>
      <div class="title">Feature Flags</div>
      <div class="small muted">Owner-only live toggles. Changes apply instantly.</div>
    </div>
    <button class="iconBtn" id="featureFlagsCloseBtn" title="Close" type="button">âœ•</button>
  </div>
  <div class="ownerPanelBody">
    <div class="flagsGrid" id="featureFlagsGrid"></div>
    <div class="row" style="gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px;">
      <button class="btn secondary" id="featureFlagsReloadBtn" type="button">Reload</button>
      <div class="msgline" id="featureFlagsMsg"></div>
    </div>
  </div>
</div>
<!-- END: Owner Feature Flags Panel -->

<!-- START: Owner Sessions Panel -->
<div class="ownerPanel" hidden="" id="sessionsPanel">
  <div class="ownerPanelHeader">
    <div>
      <div class="title">Sessions</div>
      <div class="small muted">Owner-only live session map. Country/region is approximate.</div>
    </div>
    <button class="iconBtn" id="sessionsCloseBtn" title="Close" type="button">âœ•</button>
  </div>
  <div class="ownerPanelBody">
    <div class="row" style="gap:10px; flex-wrap:wrap; align-items:center;">
      <button class="btn secondary" id="sessionsReloadBtn" type="button">Refresh</button>
      <div class="msgline" id="sessionsMsg"></div>
    </div>
    <div class="tableWrap">
      <table class="table" id="sessionsTable">
        <thead>
          <tr><th>User</th><th>Role</th><th>Room</th><th>Connected</th><th>UA</th><th>TZ</th></tr>
        </thead>
        <tbody id="sessionsTbody"></tbody>
      </table>
    </div>
  </div>
</div>
<!-- END: Owner Sessions Panel -->
</div>
<!-- === Media Bottom Sheet === -->
<div id="mediaSheetBackdrop" class="media-sheet-backdrop hidden"></div>

<div id="mediaSheet" class="media-sheet hidden" role="dialog" aria-modal="true">
  <div class="media-sheet-handle"></div>

  <button id="mediaPickImage" class="media-sheet-btn" type="button">
    <span class="media-icon">ğŸ–¼ï¸</span>
    <span>Image / Video</span>
  </button>

  <button id="mediaPickAudio" class="media-sheet-btn" type="button">
    <span class="media-icon">ğŸµ</span>
    <span>Audio Upload</span>
  </button>

  <button id="mediaPickVoice" class="media-sheet-btn" type="button">
    <span class="media-icon">ğŸ™ï¸</span>
    <span>Voice Message</span>
  </button>

  <button id="mediaSheetCancel" class="media-sheet-cancel" type="button">
    Cancel
  </button>
</div>


<!-- === Themes Modal v2 === -->
<div id="themesModal" class="themesModal" aria-hidden="true">
  <div class="themesModalCard" role="dialog" aria-modal="true" aria-label="Themes">
    <div class="themesModalSticky">
      <div class="themesModalHeader">
        <div class="themesModalTitle">Themes</div>
        <button class="iconBtn" id="themesModalClose" type="button" aria-label="Close">âœ•</button>
      </div>
      <div class="themesModalSearchRow">
        <input id="themesModalSearch" type="search" placeholder="Search themes" autocomplete="off" />
        <button class="btn secondary" id="themesFiltersBtn" type="button">Filters</button>
        <select id="themesModalSort">
          <option value="recommended">Recommended</option>
          <option value="newest">Newest</option>
          <option value="az">Aâ€“Z</option>
          <option value="favorites">Favorites first</option>
          <option value="pinned">Pinned first</option>
        </select>
      </div>
      <div class="themesModalFilters" id="themesModalFilters"></div>
    </div>
    <div class="themesModalBody" id="themesModalBody">
      <div class="themesListPane">
        <div class="themesSection" id="themesPinnedSection">
          <div class="themesSectionHeader">Pinned</div>
          <div class="themesGrid" id="themesPinnedGrid"></div>
        </div>
        <div class="themesSection">
          <div class="themesSectionHeader">All themes</div>
          <div class="themesGrid" id="themesAllGrid"></div>
          <div class="themesEmpty" id="themesEmptyState">No themes match your filters.</div>
        </div>
      </div>
      <div class="themesPreviewPane">
        <div class="themesPreviewCard">
          <div class="themesPreviewHeader">
            <div class="themesPreviewTitle">Preview</div>
            <div class="themesPreviewName" id="themesPreviewName">â€”</div>
          </div>
          <div class="themesPreviewFrame" id="themesPreviewFrame" data-theme="">
            <div class="themesPreviewTopbar">Banter &amp; Brats</div>
            <div class="themesPreviewChat">
              <div class="themesPreviewMsg">
                <div class="themesPreviewAvatar"></div>
                <div class="themesPreviewBubble">Hey! Ready for a new vibe?</div>
              </div>
              <div class="themesPreviewMsg self">
                <div class="themesPreviewAvatar"></div>
                <div class="themesPreviewBubble">Absolutely. Letâ€™s roll.</div>
              </div>
              <div class="themesPreviewMsg">
                <div class="themesPreviewAvatar"></div>
                <div class="themesPreviewBubble">Preview looks clean âœ¨</div>
              </div>
            </div>
            <div class="themesPreviewComposer">
              <div class="themesPreviewInput">Type a messageâ€¦</div>
              <button class="themesPreviewSend" type="button">Send</button>
            </div>
          </div>
          <div class="themesPreviewActions">
            <button class="btn btnPrimary" id="themesApplyBtn" type="button">Apply theme</button>
            <button class="btn secondary" id="themesBuyBtn" type="button">Buy for 0 Gold</button>
          </div>
          <div class="themesPreviewHint small muted" id="themesPreviewHint">Select a theme to preview it here.</div>
        </div>
      </div>
    </div>
  </div>
  <div class="themesFiltersSheet" id="themesFiltersSheet" aria-hidden="true">
    <div class="themesFiltersSheetCard">
      <div class="themesFiltersSheetHeader">
        <div class="themesFiltersSheetTitle">Filters</div>
        <button class="iconBtn" id="themesFiltersSheetClose" type="button" aria-label="Close filters">âœ•</button>
      </div>
      <div class="themesFiltersSheetBody" id="themesFiltersSheetBody"></div>
    </div>
  </div>
  <div class="themesActionSheet" id="themesActionSheet" aria-hidden="true">
    <div class="themesActionSheetCard">
      <div class="themesActionSheetTitle" id="themesActionSheetTitle">Theme actions</div>
      <button class="btn secondary" id="themesActionPinBtn" type="button">Pin theme</button>
      <button class="btn secondary" id="themesActionFavoriteBtn" type="button">Favorite</button>
      <button class="btn secondary" id="themesActionApplyBtn" type="button">Apply</button>
      <button class="btn secondary" id="themesActionBuyBtn" type="button">Buy for 0 Gold</button>
      <button class="btn" id="themesActionCloseBtn" type="button">Close</button>
    </div>
  </div>
</div>


<!-- === Chess Modal === -->
<div class="chessModal" id="chessModal" hidden="">
  <div class="modalCard chessModalCard">
    <div class="modalHeader chessModalHeader">
      <div>
        <div class="title">Chess Table</div>
        <div class="small muted" id="chessContextLabel">Room</div>
      </div>
      <div class="row" style="gap:8px;">
        <button class="btn secondary" id="chessLeaderboardBtn" type="button">Leaderboard</button>
        <button aria-label="Close chess" class="iconBtn" id="chessCloseBtn" title="Close" type="button">âœ•</button>
      </div>
    </div>
    <div class="chessModalBody">
      <div class="chessBoardWrap">
        <div class="chessBoard" id="chessBoard"></div>
        <div class="chessPromotion" id="chessPromotion" hidden=""></div>
      </div>
      <div class="chessSidePanel">
        <div class="chessSeats" id="chessSeats"></div>
        <div class="chessStatus" id="chessStatus"></div>
        <div class="chessActions">
          <button class="btn secondary" id="chessCreateBtn" type="button">Start Table</button>
          <button class="btn secondary" id="chessResignBtn" type="button">Resign</button>
          <button class="btn secondary" id="chessDrawOfferBtn" type="button">Offer Draw</button>
          <button class="btn secondary" id="chessDrawAcceptBtn" type="button">Accept Draw</button>
        </div>
        <div class="chessMeta" id="chessMeta"></div>
      </div>
    </div>
  </div>
</div>


<!-- === Voice Recorder Modal === -->
<div id="voiceRecBackdrop" class="voice-rec-backdrop hidden" aria-hidden="true"></div>
<div id="voiceRecModal" class="voice-rec-modal hidden" role="dialog" aria-modal="true" aria-label="Voice recorder">
  <div class="voice-rec-card">
    <div class="voice-rec-head">
      <div class="voice-rec-title">Voice message</div>
      <button id="voiceRecClose" class="voice-rec-x" type="button" aria-label="Close">âœ•</button>
    </div>

    <div class="voice-rec-body">
      <div class="voice-rec-status">
        <div id="voiceRecTimer" class="voice-rec-timer">00:00</div>
        <div id="voiceRecWave" class="voice-rec-wave" aria-hidden="true"></div>
      </div>

      <audio id="voiceRecAudio" class="voice-rec-audio hidden" controls></audio>

      <div class="voice-rec-actions">
        <button id="voiceRecStartStop" class="btn btnPrimary" type="button">Start</button>
        <button id="voiceRecRerecord" class="btn btnSecondary" type="button" disabled>Re-record</button>
        <button id="voiceRecSend" class="btn btnPrimary" type="button" disabled>Send</button>
      </div>

      <div id="voiceRecHint" class="small muted" style="margin-top:8px;">
        Tip: tap Start, then Stop when youâ€™re done. You can preview before sending.
      </div>
    </div>
  </div>
</div>



<!-- ROOM MANAGEMENT MODALS (moved out of profile modal to prevent stuck overlay) -->
<div id="roomManageModal" class="roomModal" hidden="">
  <div class="modalCard roomModalCard">
    <div class="modalTop">
      <strong>Manage Rooms</strong>
      <button class="iconBtn smallIcon" id="roomManageCloseBtn" title="Close" type="button">âœ•</button>
    </div>
    <div class="modalBody roomModalBody">
      <div class="tabs roomManageTabs">
        <button class="tab active" data-room-manage-tab="masters" type="button">Masters</button>
        <button class="tab" data-room-manage-tab="categories" type="button">Subcategories</button>
        <button class="tab" data-room-manage-tab="rooms" type="button">Rooms</button>
        <button class="tab" data-room-manage-tab="create" type="button">Create</button>
        <button class="tab" data-room-manage-tab="events" type="button">Room Events</button>
      </div>
      <div class="roomManageSection active" data-room-manage-section="masters">
        <div class="field">
          <label for="roomMasterCreateInput">New master</label>
          <div class="row" style="gap:8px; flex-wrap:wrap;">
            <input id="roomMasterCreateInput" maxlength="40" placeholder="Master name"/>
            <button class="btn" id="roomMasterCreateBtn" type="button">Create</button>
          </div>
          <div class="msgline" id="roomMasterMsg"></div>
        </div>
        <div class="roomManageList" id="roomMasterList"></div>
      </div>
      <div class="roomManageSection" data-room-manage-section="categories">
        <div class="field">
          <label for="roomCategoryMasterSelect">Master</label>
          <select id="roomCategoryMasterSelect"></select>
        </div>
        <div class="field">
          <label for="roomCategoryCreateInput">New subcategory</label>
          <div class="row" style="gap:8px; flex-wrap:wrap;">
            <input id="roomCategoryCreateInput" maxlength="40" placeholder="Subcategory name"/>
            <button class="btn" id="roomCategoryCreateBtn" type="button">Create</button>
          </div>
          <div class="msgline" id="roomCategoryMsg"></div>
        </div>
        <div class="roomManageList" id="roomCategoryList"></div>
      </div>
      <div class="roomManageSection" data-room-manage-section="rooms">
        <div class="field">
          <label for="roomManageMasterSelect">Master</label>
          <select id="roomManageMasterSelect"></select>
        </div>
        <div class="field">
          <label for="roomManageCategorySelect">Subcategory</label>
          <select id="roomManageCategorySelect"></select>
        </div>
        <label class="chk"><input type="checkbox" id="roomManageShowArchived"> Show archived rooms</label>
        <div class="roomManageList" id="roomManageRoomList"></div>
        <div class="msgline" id="roomManageMsg"></div>
      </div>
      <div class="roomManageSection" data-room-manage-section="create" id="roomManageTab_create">
        <form id="roomCreateForm">
          <div class="field">
            <label for="roomCreateName">Room name</label>
            <input id="roomCreateName" maxlength="24" placeholder="room-name"/>
          </div>
          <div class="field">
            <label for="roomCreateMaster">Master group</label>
            <select id="roomCreateMaster"></select>
          </div>
          <div class="field">
            <label for="roomCreateCategory">Subcategory</label>
            <select id="roomCreateCategory"></select>
          </div>

          <div class="roomManageSettingsGrid" data-admin-only>
            <label class="chk"><input type="checkbox" id="roomCreateVipOnly"> VIP only</label>
            <label class="chk"><input type="checkbox" id="roomCreateStaffOnly"> Staff only</label>
            <label class="chk"><input type="checkbox" id="roomCreateLocked"> Locked</label>
            <label class="chk"><input type="checkbox" id="roomCreateMaintenance"> Maintenance</label>
            <label class="chk"><input type="checkbox" id="roomCreateEventsEnabled" checked> Events enabled</label>
            <label class="mini">Min level <input type="number" id="roomCreateMinLevel" min="0" max="999" value="0"></label>
          </div>

          <div class="row" style="gap:8px; flex-wrap:wrap; margin-top:10px;">
            <button class="btn" type="submit">Create</button>
            <div class="msgline" id="roomManageCreateMsg"></div>
          </div>
        </form>
      </div>
      <div class="roomManageSection" data-room-manage-section="events" id="roomManageTab_events">
        <div class="field">
          <label for="roomEventsRoomSelect">Room</label>
          <select id="roomEventsRoomSelect"></select>
        </div>
        <div class="field">
          <label for="roomEventsType">Event type</label>
          <select id="roomEventsType">
            <option value="announcement">Announcement</option>
            <option value="prompt">Prompt</option>
            <option value="flair">Visual Flair</option>
          </select>
        </div>
        <div class="field">
          <label for="roomEventsText">Text</label>
          <textarea id="roomEventsText" rows="3" placeholder="Announcement or prompt text (optional for prompts)."></textarea>
        </div>
        <div class="row" style="gap:8px; flex-wrap:wrap;">
          <div class="field" style="flex:1; min-width:160px;">
            <label for="roomEventsDuration">Duration (seconds, 0 = no end)</label>
            <input id="roomEventsDuration" type="number" min="0" max="86400" value="600"/>
          </div>
        </div>
        <div class="row" style="gap:8px; flex-wrap:wrap; margin-top:10px;">
          <button class="btn" id="roomEventsStartBtn" type="button">Start event</button>
          <div class="msgline" id="roomEventsMsg"></div>
        </div>

        <div class="roomEventsActive">
          <div class="muted" style="margin:10px 0 6px;">Active events</div>
          <div id="roomEventsActiveList" class="roomEventsList"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="roomCreateModal" class="roomModal" hidden="">
  <div class="modalCard roomModalCard">
    <div class="modalTop">
      <strong>Create Room</strong>
      <button class="iconBtn smallIcon" id="roomCreateCloseBtn" title="Close" type="button">âœ•</button>
    </div>
    <div class="modalBody roomModalBody">
      <div class="field">
        <label for="roomCreateNameInput">Room name</label>
        <input id="roomCreateNameInput" maxlength="24" placeholder="room-name"/>
      </div>
      <div class="field">
        <label for="roomCreateMasterSelect">Master group</label>
        <select id="roomCreateMasterSelect"></select>
      </div>
      <div class="field">
        <label for="roomCreateCategorySelect">Subcategory</label>
        <select id="roomCreateCategorySelect"></select>
      </div>
      <div class="row" style="gap:8px; flex-wrap:wrap;">
        <button class="btn" id="roomCreateSubmitBtn" type="button">Create</button>
        <button class="btn secondary" id="roomCreateCancelBtn" type="button">Cancel</button>
        <div class="msgline" id="roomCreateMsg"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
